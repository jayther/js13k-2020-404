!function(r,i){var w={t:"Mail Delivery",width:640,height:360,minMailableRooms:2,maxMailableRoomRate:.25,minMissingPeople:5,maxMissingPeople:10},F={i:{h:"robot_3Dblue.png"},s:{n:"repeat",e:"repeat",r:"repeat"},o:{},u:{}};function S(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(t),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(h[e]=n[e])}return h}function t(){return S.apply(this,[{}].concat(Array.prototype.slice.call(arguments)))}var h,o=(h={},{a:function(t){return h[t]||(h[t]=i.getElementById(t)),h[t]},create:function(t){return i.createElement(t)}});function e(t,i,h){var s={c:t,f:!1,l:i,w:h,v:function(t){t.keyCode===s.c&&(!s.f&&s.l&&s.l(),s.f=!0),t.preventDefault()},d:function(t){t.keyCode===s.c&&(s.f&&s.w&&s.w(),s.f=!1),t.preventDefault()},p:function(){r.removeEventListener("keydown",s.v,!1),r.removeEventListener("keyup",s.d,!1)}};return r.addEventListener("keydown",s.v,!1),r.addEventListener("keyup",s.d,!1),s}e.keys={M:65,m:87,b:83,g:68,left:37,k:38,right:39,O:40,I:32,C:13};var z=null;z={D:function(t,i){return t+Math.random()*(i-t)},P:function(t,i){return Math.floor(z.D(t,i))},R:function(t){return t[z.P(0,t.length)]},A:function(t){var i=z.P(0,t.length),h=t[i];return t.splice(i,1),h}};var T={j:function(t,i){return t.left<i.right&&t.right>i.left&&t.top<i.bottom&&t.bottom>i.top},Q:function(t){return Math.atan2(t.y,t.x)},F:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},S:function(t,i){var h=Math.cos(i),s=Math.sin(i);return{x:t.x*h-t.y*s,y:t.x*s+t.y*h}},z:function(t,i,h){if(0===h)return{left:t.left,top:t.top,right:t.right,bottom:t.bottom};var s,n,e=t.right-t.left,r=t.bottom-t.top,o=h/360*Math.PI*2;return 90!==h&&270!==h||(n=e,e=r,r=n),(s=90===h?{x:t.left,y:t.bottom}:180===h?{x:t.right,y:t.bottom}:{x:t.right,y:t.top}).x-=i.x,s.y-=i.y,s=T.S(s,o),{left:i.x+s.x,top:i.y+s.y,right:i.x+s.x+e,bottom:i.y+s.y+r}}};function f(t,i,h,s){this.x=t||0,this.y=i||0,this.T=h||0,this.W=s||0}function d(t){this.B=S({N:null,H:null,from:0,V:1,X:1,Y:d._.L,q:null},t||{}),this.G=-1,this.U=-1,this.J=!1}function u(){this.K=0,this.Z=[]}function s(t){var i=S({x:0,y:0,$:1,tt:1,angle:0,it:!0,alpha:1,ht:0,st:0},t||{});this.nt=null,this.x=i.x,this.y=i.y,this.$=i.$,this.tt=i.tt,this.angle=i.angle,this.it=i.it,this.alpha=i.alpha,this.ht=i.ht,this.st=i.st}function a(t){s.apply(this,arguments),this.et=[]}function W(t){s.apply(this,arguments);var i=S({m:0,rt:0,ot:"black",ut:0},t||{});this.ut=i.ut,this.m=i.m,this.rt=i.rt,this.ot=i.ot}function n(t){s.apply(this,arguments);var i=S({m:0,rt:0,at:null},t||{});this.m=i.m,this.rt=i.rt,this.at=i.at,this.m&&!i.$&&(this.$=this.m/this.at.width),this.rt&&!i.tt&&(this.tt=this.rt/this.at.height)}function c(t){s.apply(this,arguments);var i=S({ct:"",ft:"left",lt:"top",font:null,ot:"black"},t||{});this.ot=i.ot,this.ct=i.ct,this.ft=i.ft,this.lt=i.lt,this.font=i.font}function l(t){s.apply(this,arguments);var i=S({wt:[],ot:"black"},t||{});this.wt=i.wt,this.ot=i.ot}function v(t){a.apply(this,arguments);var i=S({m:100,rt:100},t||{});this.vt=o.create("canvas"),this.vt.width=i.m,this.vt.height=i.rt,this.dt=this.vt.getContext("2d")}function p(t,i,h,s,n){var e,r=[],o=s/(h-1);for(e=0;e<h;e+=1)r.push({x:e*o,y:t+i-n/2}),i*=-1;for(i*=-1,e=h-1;0<=e;e-=1)r.push({x:e*o,y:t+i+n/2}),i*=-1;return r}f.pt=function(t){return new f((t.left+t.right)/2,(t.top+t.bottom)/2,(t.right-t.left)/2,(t.bottom-t.top)/2)},(f.prototype={}).yt=function(t,i){this.x=t||0,this.y=i||0},f.prototype.Mt=function(){return this.x-this.T},f.prototype.mt=function(){return this.y-this.W},f.prototype.bt=function(){return this.x+this.T},f.prototype.xt=function(){return this.y+this.W},f.prototype.gt=function(){return 2*this.T},f.prototype.kt=function(){return 2*this.W},f.prototype.Ot=function(t){return Math.abs(this.x-t.x)<this.T+t.T&&Math.abs(this.y-t.y)<this.W+t.W},f.prototype.It=function(t,i){return Math.abs(this.x-t)<this.T&&Math.abs(this.y-i)<this.W},f.prototype.Ct=function(){return new f(this.x,this.y,this.T,this.W)},f.prototype.Dt=function(t){return this.T+=t,this.W+=t,this},f.prototype.Pt=function(t,i){var h,s=i/360*Math.PI*2;90!==i&&270!==i||(h=this.T,this.T=this.W,this.W=h);var n=T.S({x:this.x-t.x,y:this.y-t.y},s);return this.x=t.x+n.x,this.y=t.y+n.y,this},f.prototype.Rt=function(){return{left:this.x-this.T,top:this.y-this.W,right:this.x+this.T,bottom:this.y+this.W}},d._={L:function(t){return t},At:function(t){return t*t},jt:function(t){return t*(2-t)},Qt:function(t){return t<.5?2*t*t:(4-2*t)*t-1},Ft:function(t){return t*t*t},St:function(t){return--t*t*t+1},zt:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Tt:function(t){return t*t*t*t},Wt:function(t){return 1- --t*t*t*t},Bt:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Et:function(t){return t*t*t*t*t},Nt:function(t){return 1+--t*t*t*t*t},Ht:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},d.prototype={Vt:function(t){this.G=t,this.U=t+this.B.X},Xt:function(t){if(this.B.N&&this.B.H){var i=(t-this.G)/this.B.X;1<i&&(i=1);var h=this.B.Y(i),s=this.B.from+(this.B.V-this.B.from)*h;this.B.N[this.B.H]=s}},Yt:function(){this.J=!0}},u.Lt=null,u.prototype={_t:function(t){t.Vt(this.K),this.Z.push(t)},Xt:function(t){var i,h,s;for(i=0;i<this.Z.length;i+=1)s=!1,(h=this.Z[i]).J||h.Xt(this.K),h.J?s=!0:this.K>=h.U&&(h.B.q&&h.B.q(),s=!0),s&&(this.Z.splice(i,1),i-=1);this.K+=t}},a.prototype=t(s.prototype={qt:function(t){this.it&&.01<=this.alpha&&(t.save(),(this.x||this.y)&&t.translate(this.x,this.y),1===this.$&&1===this.tt||t.scale(this.$,this.tt),this.angle&&t.rotate(this.angle),(this.ht||this.st)&&t.translate(-this.ht/this.$,-this.st/this.tt),this.alpha<1&&(t.globalAlpha*=this.alpha),this.Gt(t),t.restore())},Gt:function(t){}},{Ut:function(t){return this.et.push(t),t.nt=this},Jt:function(t){var i=this.et.indexOf(t);return 0<=i&&(this.et.splice(i,1),t.nt=null),this},Gt:function(t){for(var i=0;i<this.et.length;i+=1)this.et[i].qt(t)}}),W.prototype=t(s.prototype,{Gt:function(t){if(t.fillStyle=this.ot,this.ut){var i=this.ut,h=this.m,s=this.rt;t.beginPath(),t.moveTo(i,0),t.lineTo(h-i,0),t.arcTo(h,0,h,i,i),t.lineTo(h,s-i),t.arcTo(h,s,h-i,s,i),t.lineTo(i,s),t.arcTo(0,s,0,s-i,i),t.lineTo(0,i),t.arcTo(0,0,i,0,i),t.closePath(),t.fill()}else t.fillRect(0,0,this.m,this.rt)}}),n.prototype=t(s.prototype,{Gt:function(t){t.drawImage(this.at,0,0)}}),c.prototype=t(s.prototype,{Gt:function(t){this.font&&(t.font=this.font),t.textAlign=this.ft,t.textBaseline=this.lt,t.fillStyle=this.ot,t.fillText(this.ct,0,0)}}),l.prototype=t(s.prototype,{Gt:function(t){var i,h;for(t.beginPath(),i=0;i<this.wt.length;i+=1)h=this.wt[i],0===i?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y);t.closePath(),t.fillStyle=this.ot,t.fill()}}),v.prototype=t(a.prototype,{Kt:function(t,i){this.vt.width=t,this.vt.height=i},Ut:function(t){a.prototype.Ut.apply(this,arguments),this.Zt()},Jt:function(t){a.prototype.Jt.apply(this,arguments),this.Zt()},Zt:function(){this.dt.clearRect(0,0,this.vt.width,this.vt.height);for(var t=0;t<this.et.length;t+=1)this.et[t].qt(this.dt)},Gt:function(t){t.drawImage(this.vt,0,0)}});var y,M,m,b=((y=new v({m:70,rt:70})).Ut(new W({m:70,rt:70,ot:"#c99869"})),y.Ut(new l({wt:p(25,5,7,70,16),ot:"#c58f5c"})),y.Ut(new l({wt:p(55,5,7,70,16),ot:"#c58f5c"})),y),x=((M=new v({m:70,rt:70})).Ut(new W({m:70,rt:70,ot:"#838796"})),M.Ut(new l({wt:p(25,5,7,70,24),ot:"#7e8291"})),M.Ut(new l({wt:p(55,5,7,70,16),ot:"#7e8291"})),M),g=((m=new v({m:70,rt:70})).Ut(new W({m:70,rt:70,ot:"#acc0c1"})),m.Ut(new l({wt:p(25,5,7,70,16),ot:"#bbcbcc"})),m.Ut(new l({wt:p(55,5,7,70,16),ot:"#bbcbcc"})),m);function B(t,i){this.$t=t,this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom,this.ti=0,this.ii=[],this.hi=[],this.si=!1,this.ni=null,this.ei=0,this.ri=!1}function k(t,i,h,s,n,e,r){this.$t=k.oi++,this.ti=t,this.ui=r;var o=i-s/2,u=h;this.ai=new f((i+o)/2,(h+u)/2,(s+e/2)/2+k.ci,(n+e/2)/2+k.ci),this.fi=[new W({x:i-s/2,y:h-n/2,m:s,rt:n,ot:"#990000"}),new W({x:i-s/2-e/2,y:h-e/2,m:e,rt:e,ot:"#990000"})],this.ri=!1,this.li=-1,this.wi=-1,this.vi=null,this.di=null,this.pi=null,this.yi=null}function E(){a.apply(this,arguments),this.Mi={},this.mi=20,this.bi=1e3,this.xi=20,this.gi=20,this.ki=100,this.Oi=12,this.Ii=12,this.Ci=2,this.Di=0,this.Pi=0,this.Ri=[],this.Ai=[],this.ji=null,this.Qi=[],this.Fi=0,this.Si=0,this.zi=new v,this.Ut(this.zi)}function O(t,i){a.call(this,i),this.di=t;var h=S({vi:null},i||{});this.Ti=new f(0,0,10,10),this.Wi=new f(0,0,10,10),this.Bi=new f(0,0,10,10),this.Ei=200,this.Ni={x:0,y:0},this.Hi={x:0,y:0},this.Vi={x:0,y:0},this.vi=h.vi,this.Xi=null;var s=new n({at:F.o.h,m:19,rt:20,ht:10,st:10});this.Ut(s),this.at=s,this.Yi=!0,this.Li=!0,this._i=0}function I(t,i){a.call(this),this.qi=t,this.B=i,this.Gi=[]}function C(){I.apply(this,arguments),this.Ui=[],this.Ji=[],this.Ki=[],this.Zi=[],this.$i={},this.th={ih:60,hh:70,sh:60,nh:70},this.Di=z.P(this.th.ih,this.th.hh),this.Pi=z.P(this.th.sh,this.th.nh);var t=new W({m:w.width,rt:w.height,ot:"#333333"});if(this.Ut(t),this.vi=new E,this.Ut(this.vi),this.vi.eh(this.Di,this.Pi),this.vi.rh(),this.vi.oh(),this.vi.$=2,this.vi.tt=2,this.uh=new a({x:w.width/2,y:w.height/2}),this.Ut(this.uh),this.ah(),this.ch=!0,this.ch){var i=this.vi.Di*this.vi.mi,h=this.vi.Pi*this.vi.mi;i/h>w.width/w.height?this.vi.$=this.vi.tt=w.width/i:this.vi.$=this.vi.tt=w.height/h,this.vi.Ri.forEach(function(t){t.ni.it=!1}),this.vi.Ai[0].ni.it=!1}var s=this.fh=new O(this,{vi:this.vi});this.vi.Ut(this.fh);var n=this.vi.ji;this.fh.x=(n.left+n.right)/2*this.vi.mi,this.fh.y=(n.top+n.bottom)/2*this.vi.mi,this.fh.lh(),this.keys=[],this.wh=e(e.keys.M,function(){s.vh(E.dh.left)},function(){s.ph(E.dh.left)}),this.keys.push(this.wh),this.yh=e(e.keys.b,function(){s.vh(E.dh.bottom)},function(){s.ph(E.dh.bottom)}),this.keys.push(this.yh),this.Mh=e(e.keys.g,function(){s.vh(E.dh.right)},function(){s.ph(E.dh.right)}),this.keys.push(this.Mh),this.mh=e(e.keys.m,function(){s.vh(E.dh.top)},function(){s.ph(E.dh.top)}),this.keys.push(this.mh);this.bh(this.xh.bind(this))}function D(t,i){return t.concat(i.ii.filter(function(t){return t.ti===E.kh.gh||t.ti===E.kh.Oh}))}function P(t){t.ri=!0}function R(t){var i=new a;return i.Ut(new l({x:150,y:0,wt:[{x:20,y:0},{x:-15,y:-10},{x:-15,y:10}],ot:t})),i}function A(){I.apply(this,arguments),this.i=[],this.Ih=!1,this.Ch=new c({x:w.width/2,y:w.height/2,ct:"0%",ot:"black",ft:"center",lt:"middle",font:"32px Arial"});this.Ut(new W({m:w.width,rt:w.height,ot:"#777777"})),this.Ut(this.Ch)}function j(){this.Xt=this.Xt.bind(this),this.Dh=o.a("root");var t=o.create("canvas");t.width=w.width,t.height=w.height,this.Dh.appendChild(t),this.Ph=F,this.vt=t,this.dt=t.getContext("2d"),this.dt.font="16px Arial",this.Rh=new u,u.Lt=this.Rh,this.di=new A(this),this.K=0,this.Ah=this.Ah.bind(this),r.addEventListener("resize",this.jh.bind(this),!1),this.jh(),this.Xt(0),this.di.create()}F.o.n=b.vt,F.o.r=x.vt,F.o.e=g.vt,B.prototype={},k.oi=0,k.ci=5,k.prototype={Qh:function(h,t){var s=t/360*Math.PI*2;this.fi.forEach(function(t){var i=T.S({x:t.x-h.x,y:t.y-h.y},s);t.x=h.x+i.x,t.y=h.y+i.y,t.angle=s}),this.ai.Pt(h,t)},Fh:function(t){if(this.ri=!1,this.fi.forEach(function(t){t.ot="red",null===this.vi&&(this.vi=t.nt)},this),-1===this.li){var i=new W({x:t.x,y:t.y,m:20,rt:10,ot:"#eeeeee",ht:10,st:5,angle:z.D(0,2*Math.PI)});this.vi.Ut(i);var h=new d({N:i,H:"x",from:t.x,V:this.ai.x,X:.5,Y:d._.Ft}),s=new d({N:i,H:"y",from:t.y,V:this.ai.y,X:.5,Y:d._.Ft,q:function(){this.vi.Jt(i)}.bind(this)}),n=new d({N:i,H:"angle",from:i.angle,V:i.angle+z.D(-Math.PI,Math.PI),X:.5});u.Lt._t(h),u.Lt._t(s),u.Lt._t(n),-1!==this.wi&&this.yi&&this.yi(this)}else this.pi&&this.pi(this)}},E.Sh={zh:1,Th:2,Wh:3,Bh:4},E.Eh=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:0,y:0},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],E.Nh={Hh:1,Vh:2,Xh:3,Yh:4,Lh:5},E.kh={gh:1,Oh:2,_h:3,qh:4},E.dh={right:1,bottom:2,left:4,top:8},E.Gh={width:40,Uh:20,Jh:20,ti:E.kh.gh},E.Kh={width:85,Uh:20,Jh:20,Zh:5,ti:E.kh.Oh},E.$h={width:80,Uh:20,Jh:20,Zh:10,ti:E.kh.gh},E.ci=5,E.prototype=t(a.prototype,{eh:function(t,i){var h,s,n,e,r,o,u=t,a=i;for(this.zi.Kt(u*this.mi,a*this.mi),this.zi.Ut(new W({x:0*this.mi,y:0*this.mi,m:u*this.mi,rt:a*this.mi,ot:F.u.r})),this.zi.Ut(new W({x:1*this.mi,y:1*this.mi,m:(u-2)*this.mi,rt:(a-2)*this.mi,ot:F.u.n})),this.Di=u,this.Pi=a,h=0;h<u;h+=1)this.ts(h,0,E.Sh.Th),this.ts(h,a-1,E.Sh.Th);for(h=0;h<a;h+=1)this.ts(0,h,E.Sh.Th),this.ts(u-1,h,E.Sh.Th);for(var c,f,l,w,v,d,p,y=z.P(0,2),M={left:1,top:1,right:u-1,bottom:a-1,hs:y},m=[M],b=[],x=[],g=0,k=0,O=this.xi,I=this.gi,C=this.bi;0<m.length&&g<1e4;)if(f=S({},M=m.shift()),l=null,p=0===(y=M.hs)?(d="right","left"):(d="bottom","top"),0===k?(v=S({},M),3,l=S({},M),c=z.P(M[p]+O/2,M[d]-O/2),f[d]=c-this.Ci/2-1,l[p]=c+this.Ci/2+1,v[d]=c+this.Ci/2,v[p]=c-this.Ci/2,v.ss=!0,b.push(v)):(l=S({},M),c=z.P(M[p]+O/2,M[d]-O/2),f[d]=c,l[p]=c+1),n=f.right-f.left,e=f.bottom-f.top,O<n&&I<e&&C<n*e?(f.hs=0===k?y?0:1:e<n?0:1,m.push(f)):x.push(f),l&&(n=l.right-l.left,e=l.bottom-l.top,O<n&&I<e&&I<n*e?(l.hs=0===k?y?0:1:e<n?0:1,m.push(l)):x.push(l)),g+=1,0===k&&0===m.length)for(k+=1,O=this.Oi,I=this.Ii,C=this.ki,h=x.length-1;0<=h;h-=1)n=(f=x[h]).right-f.left,e=f.bottom-f.top,O<n&&I<e&&C<n*e&&(f.hs=e<n?0:1,m.push(f),x.splice(h,1));if(1e4<=g)throw new Error("Infinite loop in partitioning");for(this.Ai=b,h=0;h<b.length;h+=1)for(n=(v=b[h]).left;n<v.right;n+=1)for(e=v.top;e<v.bottom;e+=1)this.ts(n,e,E.Sh.zh,v);var D,P=[];for(h=0;h<x.length;h+=1){for(M=x[h],this.zi.Ut(new W({x:(M.left-1)*this.mi,y:(M.top-1)*this.mi,m:(M.right-M.left+2)*this.mi,rt:(M.bottom-M.top+2)*this.mi,ot:F.u.r})),this.zi.Ut(new W({x:M.left*this.mi,y:M.top*this.mi,m:(M.right-M.left)*this.mi,rt:(M.bottom-M.top)*this.mi,ot:F.u.e})),n=M.left-1;n<M.right+1;n+=1)this.ts(n,M.top-1,E.Sh.Th),this.ts(n,M.bottom,E.Sh.Th);for(e=M.top-1;e<M.bottom+1;e+=1)this.ts(M.left-1,e,E.Sh.Th),this.ts(M.right,e,E.Sh.Th);for(w=new B(this.Si++,M),n=M.left;n<M.right;n+=1)for(e=M.top;e<M.bottom;e+=1)this.ts(n,e,E.Sh.Bh,w);P.push(w)}for(g=0;0<P.length&&g<1e4;){m=g<x.length?b:this.Ri;var R=[];for((D=S({},M=P.shift())).top+=1,D.bottom-=1,D.left-=2,D.right+=2,s=0;s<m.length;s+=1)f=m[s],T.j(D,f)&&R.push(f);for(D.left=M.left+1,D.right=M.right-1,D.top=M.top-2,D.bottom=M.bottom+2,s=0;s<m.length;s+=1)f=m[s],R.indexOf(f)<0&&T.j(D,f)&&R.push(f);if(0<R.length){var A=0;f=z.R(R),D.left=M.left,D.top=M.top,D.right=M.right,D.bottom=M.bottom;var j=!1;D.left-=2,T.j(D,f)&&(j=!0,r=n=f.right,o=(e=z.P(Math.max(M.top,f.top),Math.min(M.bottom,f.bottom)-1))+1,A=E.dh.left),j||(D.left=M.left,D.top-=2,T.j(D,f)&&(j=!0,r=(n=z.P(Math.max(M.left,f.left),Math.min(M.right,f.right)-1))+1,o=e=f.bottom,A=E.dh.top)),j||(D.top=M.top,D.right+=2,T.j(D,f)&&(j=!0,r=n=f.left-1,o=(e=z.P(Math.max(M.top,f.top),Math.min(M.bottom,f.bottom)-1))+1,A=E.dh.right)),j||(r=(n=z.P(Math.max(M.left,f.left),Math.min(M.right,f.right)-1))+1,o=e=f.top-1,A=E.dh.bottom),this.ts(n,e,E.Sh.Wh),this.ts(r,o,E.Sh.Wh),M.si=!0,this.Ri.push(M),M.ei||(M.ei=0),f.ei||(f.ei=0),M.ei|=A;var Q=A<<2;8<Q&&(Q>>=4),f.ei|=Q}else M.si=!1,P.push(M);g+=1}if(1e4<=g)throw new Error("Infinite loop in door placements")},oh:function(){var t,i,h,s=this.Ai;for(h=0;h<this.Ri.length;h+=1)i=this.Ri[h],t=new W({x:Math.floor((i.left-.5)*this.mi),y:Math.floor((i.top-.5)*this.mi),m:Math.floor((i.right-i.left+1)*this.mi),rt:Math.floor((i.bottom-i.top+1)*this.mi)}),this.Ut(t),i.ni=t;var n=new a;for(this.Ut(n),h=0;h<s.length;h+=1)i=s[h],t=new W({x:Math.floor((i.left-.5)*this.mi),y:Math.floor((i.top-.5)*this.mi),m:Math.floor((i.right-i.left+1)*this.mi),rt:Math.floor((i.bottom-i.top+1)*this.mi)}),n.Ut(t),i.ni=n},rh:function(){var t,i,h=this.Ri.slice(),s=z.A(h);for(s.ti=E.Nh.Hh,this.ns(s),this.ji=s;0<h.length;)t=[],200<(i=((s=z.A(h)).right-s.left)*(s.bottom-s.top))&&t.push(E.Nh.Xh),100<=i&&t.push(E.Nh.Lh),i<100&&t.push(E.Nh.Yh),100<=i&&(0===this.Qi.length||Math.random()<.1)&&t.push(E.Nh.Vh),s.ti=z.R(t),s.ti===E.Nh.Vh&&this.Qi.push(s),this.ns(s)},es:function(i,h,t,s){var n,e,r=s.width/2,o=s.Uh/2,u=s.Jh/2,a=[];if(n=[new f(i-o-u/2,h,o+u/2,r)],s.ti===E.kh.Oh){var c=(s.width-s.Zh)/2;a.push(new k(s.ti,i-o,h-c/2-s.Zh/2,s.Uh,c,s.Jh)),a.push(new k(s.ti,i-o,h+c/2+s.Zh/2,s.Uh,c,s.Jh))}else a.push(new k(s.ti,i-o,h,s.Uh,s.width,s.Jh));return e=t===E.dh.left?180:t===E.dh.top?270:t===E.dh.right?0:90,n.forEach(function(t){t.Pt({x:i,y:h},e)}),a.forEach(function(t){t.Qh({x:i,y:h},e)}),[n,a]},ns:function(i){var t=null,h={left:i.left*this.mi,top:i.top*this.mi,right:i.right*this.mi,bottom:i.bottom*this.mi};i.ei&E.dh.left&&(h.left+=1.5*this.mi),i.ei&E.dh.top&&(h.top+=1.5*this.mi),i.ei&E.dh.right&&(h.right-=1.5*this.mi),i.ei&E.dh.bottom&&(h.bottom-=1.5*this.mi),i.ti===E.Nh.Lh?t=this.rs(h):i.ti===E.Nh.Yh&&(t=this.os(h,i)),t&&(i.hi=t[0],i.ii=t[1]);var s=new W({x:h.left,y:h.top,m:h.right-h.left,rt:h.bottom-h.top,ot:"#007700"});this.Ut(s),i.ii.forEach(function(t){t.ui=i,t.fi.forEach(function(t){this.Ut(t)},this)},this);var n=(i.left+i.right)/2*this.mi,e=(i.top+i.bottom)/2*this.mi,r=new c({ct:["Unknown","Mailroom","Lobby","Bullpen","Private","Open"][i.ti],x:n,y:e,ft:"center",lt:"middle",font:"36px Arial"});this.Ut(r)},rs:function(t,i){var h,s,n,e,r,o,u,a=t.right-t.left,c=t.bottom-t.top,f=[],l=[],w=z.R([E.Gh,E.Kh]),v=w.Uh+50,d=w.width/2,p=w.Jh/2,y=z.P(0,2);if(c<a){for(r=Math.floor(a/v),o=Math.random()*(a-r*v),e=t.top+d;e+d<t.bottom;){for(h=0;h<r;h+=1)n=t.left+h*v+y*(w.Uh+p)+o,s=this.es(n,e,y?E.dh.right:E.dh.left,w),f=f.concat(s[0]),l=l.concat(s[1]);e+=50+w.width}var M=null,m=null;f.forEach(function(t){(!M||t.y<M.y)&&(M=t),(!m||t.y>m.y)&&(m=t)}),u=Math.random()*(c-(m.y+m.W-(M.y-M.W))),f.forEach(function(t){t.y+=u}),l.forEach(function(t){t.fi.forEach(function(t){t.y+=u}),t.ai.y+=u})}else{for(r=Math.floor(c/v),o=Math.random()*(c-r*v),n=t.left+d;n+d<t.right;){for(h=0;h<r;h+=1)e=t.top+h*v+y*(w.Uh+p)+o,s=this.es(n,e,y?E.dh.bottom:E.dh.top,w),f=f.concat(s[0]),l=l.concat(s[1]);n+=50+w.width}var b=null,x=null;f.forEach(function(t){(!b||t.x<b.x)&&(b=t),(!x||t.x>x.x)&&(x=t)}),u=Math.random()*(a-(x.x+x.T-(b.x-b.T))),f.forEach(function(t){t.x+=u}),l.forEach(function(t){t.fi.forEach(function(t){t.x+=u}),t.ai.x+=u})}return[f,l]},os:function(t,i){t.right,t.left,t.bottom,t.top;var h,s,n=0,e=[];for(h=1;h<=8&&!n;h<<=1)h===i.ei?n=h:0<(i.ei&h)&&e.push(h);if(n||(5===i.ei?n=z.R([1,4]):10===i.ei&&(n=z.R([2,8]))),!n)for(s=1;s<=8&&!n;s<<=1)h=s,h|=8<s<<1?1:s<<1,(h|=s>>1<1?8:s>>1)===i.ei&&(n=s);n||(n=z.R(e));var r,o,u,a,c=E.$h,f=c.Uh+c.Jh/2,l=c.width/2,w=f+c.Zh;return n===E.dh.left||n===E.dh.right?(u=t.top+l,o=(a=t.bottom-l)<=u?(t.top+t.bottom)/2:z.D(u,a)):(u=t.left+l,r=(a=t.right-l)<=u?(t.left+t.right)/2:z.D(u,a)),n===E.dh.right?r=t.left+w:n===E.dh.left?r=t.right-w:o=n===E.dh.bottom?t.top+w:t.bottom-w,this.es(r,o,n,c)},us:function(t,i,h,s){var n=null,e=null,r=this.mi/2,o=null,u=!0;switch(h){case E.Sh.Th:e=new f(t*this.mi+r,i*this.mi+r,r,r),u=!1;break;case E.Sh.zh:u=!0;break;case E.Sh.Wh:n="#00aa00",u=!0;break;case E.Sh.Bh:u=!0}return n&&(o=new W({x:t*this.mi,y:i*this.mi,m:this.mi,rt:this.mi,ot:n})),{ti:h,as:o,Ti:e,ui:s,cs:u}},fs:function(t,i){return this.Mi[t]&&this.Mi[t][i]?this.Mi[t][i]:null},ts:function(t,i,h,s){this.Mi[t]||(this.Mi[t]={});var n=this.Mi[t][i];n&&n.as&&this.Jt(n.as),n=this.us(t,i,h,s),(this.Mi[t][i]=n).as&&this.Ut(n.as)},ls:function(t,i){return this.fs(Math.floor(t/this.mi),Math.floor(i/this.mi))},ws:function(t,i){var h,s,n=[],e=Math.floor(t/this.mi),r=Math.floor(i/this.mi),o=null,u=E.Eh;for(s=0;s<u.length;s+=1)h=u[s],(o=this.fs(e+h.x,r+h.y))&&n.push(o);return n}}),O.prototype=t(a.prototype,{vh:function(t){this._i|=t,this.vs()},ph:function(t){this._i^=t,this.vs()},vs:function(){this.Ni.x=0,this.Ni.y=0,this._i&E.dh.left&&(this.Ni.x-=this.Ei),this._i&E.dh.right&&(this.Ni.x+=this.Ei),this._i&E.dh.top&&(this.Ni.y-=this.Ei),this._i&E.dh.bottom&&(this.Ni.y+=this.Ei)},lh:function(){this.Wi.yt(this.Ti.x,this.Ti.y),this.Ti.yt(this.x,this.y)},Xt:function(t){var i,h,s,n,e=1,r=0,o=0;if((this.Ni.x||this.Ni.y)&&(this.at.angle=T.Q(this.Ni)),s=this.vi.ls(this.x,this.y),this.vs(),this.Li&&s&&s.ui){if(s.ui.hi){var u=s.ui.hi;for(this.ds(t),h=0;h<u.length;h+=1)(n=this.ps(u[h],t))<e&&(e=n,r=this.Vi.x,o=this.Vi.y)}if(s.ui.ii){var a=s.ui.ii,c=!1;for(h=0;h<a.length;h+=1)if(a[h].ti===E.kh.gh||a[h].ti===E.kh.Oh){var f=a[h];f.ri&&f.ai.Ot(this.Ti)&&f.Fh(this),c=c||f.ri}s.ui.ri=c}}if(this.x+=this.Ni.x*t*e,this.y+=this.Ni.y*t*e,e<1){var l=(this.Ni.x*o+this.Ni.y*r)*(1-e);this.x+=l*o*t,this.y+=l*r*t}if(this.lh(),this.Yi)for(i=this.vi.ws(this.x,this.y),h=0;h<i.length;h+=1)!(s=i[h]).cs&&s.Ti&&this.ys(s.Ti);if((s=this.vi.ls(this.x,this.y))&&s.ui&&this.Xi!==s.ui){var w=this.Xi;if(this.Xi=s.ui,w&&(!w.ss||!this.Xi.ss)){w.Ms&&(w.Ms.Yt(),w.Ms=null);var v=new d({N:w.ni,H:"alpha",from:0,V:1,X:.5});w.Ms=v,this.di.qi.Rh._t(v)}this.Xi.Ms&&(this.Xi.Ms.Yt(),this.Xi.Ms=null),this.Xi.ni.alpha=0}},ys:function(t){var i,h;t.Ot(this.Ti)&&(i=this.Ti.x-t.x,h=this.Ti.y-t.y,Math.abs(i)>Math.abs(h)?this.x=0<i?t.bt()+this.Ti.T+1:t.Mt()-this.Ti.T-1:this.y=0<h?t.xt()+this.Ti.W+1:t.mt()-this.Ti.W-1,this.lh())},ps:function(t,i){if(!this.Bi.Ot(t))return this.Vi.x=0,this.Vi.y=0,1;var h,s,n,e,r,o,u,a;n=0<this.Ni.x?(h=t.x-t.T-(this.Ti.x+this.Ti.T),t.x+t.T-(this.Ti.x-this.Ti.T)):(h=t.x+t.T-(this.Ti.x-this.Ti.T),t.x-t.T-(this.Ti.x+this.Ti.T)),e=0<this.Ni.y?(s=t.y-t.W-(this.Ti.y+this.Ti.W),t.y+t.W-(this.Ti.y-this.Ti.W)):(s=t.y+t.W-(this.Ti.y-this.Ti.W),t.y-t.W-(this.Ti.y+this.Ti.W)),u=0===this.Ni.x?(r=-Number.MAX_VALUE,Number.MAX_VALUE):(r=h/(this.Ni.x*i),n/(this.Ni.x*i)),a=0===this.Ni.y?(o=-Number.MAX_VALUE,Number.MAX_VALUE):(o=s/(this.Ni.y*i),e/(this.Ni.y*i));var c=Math.max(r,o);return Math.min(u,a)<c||r<0&&o<0||1<r||1<o?(this.Vi.x=0,this.Vi.y=0,1):(o<r?(this.Vi.x=h<0?1:-1,this.Vi.y=0):(this.Vi.x=0,this.Vi.y=s<0?1:-1),c)},ds:function(t){var i=this.Ni.x*t,h=this.Ni.y*t,s=0<this.Ni.x?this.Ti.x-this.Ti.T:this.Ti.x-this.Ti.T+i,n=0<this.Ni.y?this.Ti.y-this.Ti.W:this.Ti.y-this.Ti.W+h,e=0<this.Ni.x?this.Ti.x+this.Ti.T+i:this.Ti.x+this.Ti.T,r=0<this.Ni.y?this.Ti.y+this.Ti.W+h:this.Ti.y+this.Ti.W;this.Bi.x=(s+e)/2,this.Bi.y=(n+r)/2,this.Bi.T=(e-s)/2,this.Bi.W=(r-n)/2}}),I.prototype=t(a.prototype,{create:function(){},p:function(){},bh:function(t){this.Gi.push(t)},Xt:function(t){for(var i=0;i<this.Gi.length;i+=1)this.Gi[i](t)},qt:function(t){this.Gt(t)}}),C.prototype=t(I.prototype,{p:function(){this.keys.forEach(function(t){t.p()})},xh:function(t){this.fh.Xt(t),this.ch||(this.vi.x=Math.floor(w.width/2-this.fh.x*this.vi.$),this.vi.y=Math.floor(w.height/2-this.fh.y*this.vi.tt)),this.ms()},ms:function(){var t,i,h,s,n,e;for(t=0;t<this.Ui.length;t+=1)(i=this.Ui[t]).ri&&(e=this.$i[i.$t],this.fh.Xi!==i?(e.it=!0,h=(i.left+i.right)/2*this.vi.mi,s=(i.top+i.bottom)/2*this.vi.mi,n=Math.atan2(s-this.fh.y,h-this.fh.x),e.angle=n):e.it=!1)},ah:function(){var t,i,h,s=this.vi.Ri.filter(function(t){return t.ii&&t.ii.length&&t.ii.some(function(t){return t.ti===E.kh.gh||t.ti===E.kh.Oh})}),n=z.P(w.minMailableRooms,Math.max(w.minMailableRooms+1,Math.floor(s.length*w.maxMailableRoomRate))),e=[];for(t=0;t<n;t+=1)i=z.A(s),h=R("white"),this.uh.Ut(h),this.$i[i.$t]=h,i.ri=!0,e.push(i);var r=e.reduce(D,[]),o=s.reduce(D,[]),u=z.P(w.minMissingPeople,w.maxMissingPeople+1);u>r.length&&(u=r.length);var a,c,f=[],l=[];for(t=0;t<u;t+=1)a=z.A(r),c=z.A(o),a.li=c.$t,c.wi=a.$t,f.push(a),l.push(c),a.pi=this.bs.bind(this),c.yi=this.xs.bind(this);r.forEach(P),f.forEach(P),l.forEach(P),this.Ui=e,this.Ji=r,this.Ki=f,this.Zi=l,this.Ji.forEach(function(t){t.fi.forEach(function(t){t.ot="white"})}),this.Ki.forEach(function(t){t.fi.forEach(function(t){t.ot="blue"})}),this.Zi.forEach(function(t){t.fi.forEach(function(t){t.ot="gray"})})},bs:function(i){var t=this.Zi.find(function(t){return t.$t===i.li});if(t){if(t.ri&&-1===this.Ui.indexOf(t.ui)){t.ui.ri=!0,this.Ui.push(t.ui);var h=R("blue");this.$i[t.ui.$t]=h,this.uh.Ut(h)}}else console.log("desk "+i.li+" not found")},xs:function(i){var t=this.Ki.find(function(t){return t.$t===i.wi});t&&t.ri&&t.Fh(this.fh)}}),A.prototype=t(I.prototype,{create:function(){Object.entries(F.i).forEach(function(t){var i=new Image;i.onload=this.gs.bind(this),i.src=t[1],this.i.push(i),F.o[t[0]]=i},this)},gs:function(t){if(!this.Ih){var i=this.i.reduce(function(t,i){return(i.complete?1:0)+(t||0)},0);this.Ch.ct=Math.floor(i/this.i.length*100)+"%",i>=this.i.length&&this.ks()}},ks:function(){this.Ih||(Object.entries(F.s).forEach(function(t){F.u[t[0]]=this.qi.dt.createPattern(F.o[t[0]],t[1])},this),this.Ih=!0,this.qi.Os(new C(this.qi)))}}),j.prototype={jh:function(){this.Ah(),setTimeout(function(){this.Ah()}.bind(this),100)},Ah:function(){var t,i,h=r.getComputedStyle(o.a("root")),s=parseInt(h.width,10),n=parseInt(h.height,10),e=this.vt.width/this.vt.height;s/n<e?i=(t=s)/e:t=(i=n)*e,this.vt.style.width=Math.floor(t)+"px",this.vt.style.height=Math.floor(i)+"px",this.vt.style.position="absolute",this.vt.style.left="50%",this.vt.style.top="50%",this.vt.style.marginLeft=Math.floor(-t/2)+"px",this.vt.style.marginTop=Math.floor(-i/2)+"px"},Os:function(t){this.di&&this.di.p(),(this.di=t).create()},Xt:function(t){var i=(t-this.K)/1e3;0<i&&(.2<i&&(i=.2),this.di.Xt(i),this.di.qt(this.dt),this.Rh.Xt(i),this.K=t),requestAnimationFrame(this.Xt)}},r.game=new j}(window,document);