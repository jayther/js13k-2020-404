!function(r,i){var w={t:"Mail Delivery",width:640,height:360,minMailableRooms:2,maxMailableRoomRate:.25,minMissingPeople:5,maxMissingPeople:10},Q={i:{h:"robot_3Dblue.png"},s:{n:"repeat",e:"repeat",r:"repeat"},o:{},u:{}};function E(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(t),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(h[e]=n[e])}return h}function t(){return E.apply(this,[{}].concat(Array.prototype.slice.call(arguments)))}var h,o=(h={},{a:function(t){return h[t]||(h[t]=i.getElementById(t)),h[t]},create:function(t){return i.createElement(t)}});function e(t,i,h){var s={c:t,f:!1,l:i,w:h,v:function(t){t.keyCode===s.c&&(!s.f&&s.l&&s.l(),s.f=!0),t.preventDefault()},d:function(t){t.keyCode===s.c&&(s.f&&s.w&&s.w(),s.f=!1),t.preventDefault()},p:function(){r.removeEventListener("keydown",s.v,!1),r.removeEventListener("keyup",s.d,!1)}};return r.addEventListener("keydown",s.v,!1),r.addEventListener("keyup",s.d,!1),s}e.keys={m:65,M:87,b:83,g:68,left:37,k:38,right:39,O:40,I:32,C:13};var W=null;W={P:function(t,i){return t+Math.random()*(i-t)},D:function(t,i){return Math.floor(W.P(t,i))},R:function(t){return t[W.D(0,t.length)]},A:function(t){var i=W.D(0,t.length),h=t[i];return t.splice(i,1),h},j:function(t){for(var i=[],h=0;0<t;)1&t&&i.push(1<<h),t>>=1,h+=1;return 0<i.length?W.R(i):0}};var S={F:function(t,i){return t.left<i.right&&t.right>i.left&&t.top<i.bottom&&t.bottom>i.top},Q:function(t){return Math.atan2(t.y,t.x)},S:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},z:function(t,i){var h=Math.cos(i),s=Math.sin(i);return{x:t.x*h-t.y*s,y:t.x*s+t.y*h}},W:function(t,i,h){if(0===h)return{left:t.left,top:t.top,right:t.right,bottom:t.bottom};var s,n,e=t.right-t.left,r=t.bottom-t.top,o=h/360*Math.PI*2;return 90!==h&&270!==h||(n=e,e=r,r=n),(s=90===h?{x:t.left,y:t.bottom}:180===h?{x:t.right,y:t.bottom}:{x:t.right,y:t.top}).x-=i.x,s.y-=i.y,s=S.z(s,o),{left:i.x+s.x,top:i.y+s.y,right:i.x+s.x+e,bottom:i.y+s.y+r}}};function B(t,i,h,s){this.x=t||0,this.y=i||0,this.B=h||0,this.T=s||0}function p(t){this.N=E({H:null,L:null,from:0,V:1,X:1,Y:p.q._,G:null},t||{}),this.U=-1,this.J=-1,this.K=!1}function u(){this.Z=0,this.$=[]}function s(t){var i=E({x:0,y:0,tt:1,it:1,angle:0,ht:!0,alpha:1,st:0,nt:0},t||{});this.et=null,this.x=i.x,this.y=i.y,this.tt=i.tt,this.it=i.it,this.angle=i.angle,this.ht=i.ht,this.alpha=i.alpha,this.st=i.st,this.nt=i.nt}function a(t){s.apply(this,arguments),this.rt=[]}function T(t){s.apply(this,arguments);var i=E({M:0,ot:0,ut:"black",at:0},t||{});this.at=i.at,this.M=i.M,this.ot=i.ot,this.ut=i.ut}function n(t){s.apply(this,arguments);var i=E({M:0,ot:0,ct:null},t||{});this.M=i.M,this.ot=i.ot,this.ct=i.ct,this.M&&!i.tt&&(this.tt=this.M/this.ct.width),this.ot&&!i.it&&(this.it=this.ot/this.ct.height)}function c(t){s.apply(this,arguments);var i=E({ft:"",lt:"left",wt:"top",font:null,ut:"black"},t||{});this.ut=i.ut,this.ft=i.ft,this.lt=i.lt,this.wt=i.wt,this.font=i.font}function f(t){s.apply(this,arguments);var i=E({vt:[],ut:"black"},t||{});this.vt=i.vt,this.ut=i.ut}function l(t){a.apply(this,arguments);var i=E({M:100,ot:100},t||{});this.dt=o.create("canvas"),this.dt.width=i.M,this.dt.height=i.ot,this.pt=this.dt.getContext("2d")}function v(t,i,h,s,n){var e,r=[],o=s/(h-1);for(e=0;e<h;e+=1)r.push({x:e*o,y:t+i-n/2}),i*=-1;for(i*=-1,e=h-1;0<=e;e-=1)r.push({x:e*o,y:t+i+n/2}),i*=-1;return r}B.yt=function(t){return new B((t.left+t.right)/2,(t.top+t.bottom)/2,(t.right-t.left)/2,(t.bottom-t.top)/2)},(B.prototype={}).mt=function(t,i){this.x=t||0,this.y=i||0},B.prototype.Mt=function(){return this.x-this.B},B.prototype.bt=function(){return this.y-this.T},B.prototype.xt=function(){return this.x+this.B},B.prototype.gt=function(){return this.y+this.T},B.prototype.kt=function(){return 2*this.B},B.prototype.Ot=function(){return 2*this.T},B.prototype.It=function(t){return Math.abs(this.x-t.x)<this.B+t.B&&Math.abs(this.y-t.y)<this.T+t.T},B.prototype.Ct=function(t,i){return Math.abs(this.x-t)<this.B&&Math.abs(this.y-i)<this.T},B.prototype.Pt=function(){return new B(this.x,this.y,this.B,this.T)},B.prototype.Dt=function(t){return this.B+=t,this.T+=t,this},B.prototype.Rt=function(t,i){var h,s=i/360*Math.PI*2;90!==i&&270!==i||(h=this.B,this.B=this.T,this.T=h);var n=S.z({x:this.x-t.x,y:this.y-t.y},s);return this.x=t.x+n.x,this.y=t.y+n.y,this},B.prototype.At=function(){return{left:this.x-this.B,top:this.y-this.T,right:this.x+this.B,bottom:this.y+this.T}},B.prototype.jt=function(){return{x:this.x-this.B,y:this.y-this.T,M:2*this.B,ot:2*this.T}},p.q={_:function(t){return t},Ft:function(t){return t*t},Qt:function(t){return t*(2-t)},St:function(t){return t<.5?2*t*t:(4-2*t)*t-1},zt:function(t){return t*t*t},Et:function(t){return--t*t*t+1},Wt:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Bt:function(t){return t*t*t*t},Tt:function(t){return 1- --t*t*t*t},Nt:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},Ht:function(t){return t*t*t*t*t},Lt:function(t){return 1+--t*t*t*t*t},Vt:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},p.prototype={Xt:function(t){this.U=t,this.J=t+this.N.X},Yt:function(t){if(this.N.H&&this.N.L){var i=(t-this.U)/this.N.X;1<i&&(i=1);var h=this.N.Y(i),s=this.N.from+(this.N.V-this.N.from)*h;this.N.H[this.N.L]=s}},_t:function(){this.K=!0}},u.qt=null,u.prototype={Gt:function(t){t.Xt(this.Z),this.$.push(t)},Yt:function(t){var i,h,s;for(i=0;i<this.$.length;i+=1)s=!1,(h=this.$[i]).K||h.Yt(this.Z),h.K?s=!0:this.Z>=h.J&&(h.N.G&&h.N.G(),s=!0),s&&(this.$.splice(i,1),i-=1);this.Z+=t}},a.prototype=t(s.prototype={Ut:function(t){this.ht&&.01<=this.alpha&&(t.save(),(this.x||this.y)&&t.translate(this.x,this.y),1===this.tt&&1===this.it||t.scale(this.tt,this.it),this.angle&&t.rotate(this.angle),(this.st||this.nt)&&t.translate(-this.st/this.tt,-this.nt/this.it),this.alpha<1&&(t.globalAlpha*=this.alpha),this.Jt(t),t.restore())},Jt:function(t){}},{Kt:function(t){return this.rt.push(t),t.et=this},Zt:function(t){var i=this.rt.indexOf(t);return 0<=i&&(this.rt.splice(i,1),t.et=null),this},Jt:function(t){for(var i=0;i<this.rt.length;i+=1)this.rt[i].Ut(t)}}),T.prototype=t(s.prototype,{Jt:function(t){if(t.fillStyle=this.ut,this.at){var i=this.at,h=this.M,s=this.ot;t.beginPath(),t.moveTo(i,0),t.lineTo(h-i,0),t.arcTo(h,0,h,i,i),t.lineTo(h,s-i),t.arcTo(h,s,h-i,s,i),t.lineTo(i,s),t.arcTo(0,s,0,s-i,i),t.lineTo(0,i),t.arcTo(0,0,i,0,i),t.closePath(),t.fill()}else t.fillRect(0,0,this.M,this.ot)}}),n.prototype=t(s.prototype,{Jt:function(t){t.drawImage(this.ct,0,0)}}),c.prototype=t(s.prototype,{Jt:function(t){this.font&&(t.font=this.font),t.textAlign=this.lt,t.textBaseline=this.wt,t.fillStyle=this.ut,t.fillText(this.ft,0,0)}}),f.prototype=t(s.prototype,{Jt:function(t){var i,h;for(t.beginPath(),i=0;i<this.vt.length;i+=1)h=this.vt[i],0===i?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y);t.closePath(),t.fillStyle=this.ut,t.fill()}}),l.prototype=t(a.prototype,{$t:function(t,i){this.dt.width=t,this.dt.height=i},Kt:function(t){a.prototype.Kt.apply(this,arguments),this.ti()},Zt:function(t){a.prototype.Zt.apply(this,arguments),this.ti()},ti:function(){this.pt.clearRect(0,0,this.dt.width,this.dt.height);for(var t=0;t<this.rt.length;t+=1)this.rt[t].Ut(this.pt)},Jt:function(t){t.drawImage(this.dt,0,0)}});var d,y,m,M=((d=new l({M:70,ot:70})).Kt(new T({M:70,ot:70,ut:"#c99869"})),d.Kt(new f({vt:v(25,5,7,70,16),ut:"#c58f5c"})),d.Kt(new f({vt:v(55,5,7,70,16),ut:"#c58f5c"})),d),b=((y=new l({M:70,ot:70})).Kt(new T({M:70,ot:70,ut:"#838796"})),y.Kt(new f({vt:v(25,5,7,70,24),ut:"#7e8291"})),y.Kt(new f({vt:v(55,5,7,70,16),ut:"#7e8291"})),y),x=((m=new l({M:70,ot:70})).Kt(new T({M:70,ot:70,ut:"#acc0c1"})),m.Kt(new f({vt:v(25,5,7,70,16),ut:"#bbcbcc"})),m.Kt(new f({vt:v(55,5,7,70,16),ut:"#bbcbcc"})),m);function z(t,i){this.ii=t,this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom,this.hi=0,this.si=[],this.ni=[],this.ei=!1,this.ri=null,this.oi=0,this.ui=!1}function g(t,i,h,s,n,e,r){this.ii=g.ai++,this.hi=t,this.ci=r;var o=i-s/2,u=h;this.fi=new B((i+o)/2,(h+u)/2,(s+e/2)/2+g.li,(n+e/2)/2+g.li),this.wi=[new T({x:i-s/2,y:h-n/2,M:s,ot:n,ut:"#990000"}),new T({x:i-s/2-e/2,y:h-e/2,M:e,ot:e,ut:"#990000"})],this.ui=!1,this.vi=-1,this.di=-1,this.pi=null,this.yi=null,this.mi=null,this.Mi=null}function N(){a.apply(this,arguments),this.bi={},this.xi=20,this.gi=1e3,this.ki=20,this.Oi=20,this.Ii=100,this.Ci=12,this.Pi=12,this.Di=2,this.Ri=0,this.Ai=0,this.ji=[],this.Fi=[],this.Qi=null,this.Si=[],this.zi=0,this.Ei=0,this.Wi=new l,this.Kt(this.Wi)}function k(t,i){a.call(this,i),this.yi=t;var h=E({pi:null},i||{});this.Bi=new B(0,0,10,10),this.Ti=new B(0,0,10,10),this.Ni=new B(0,0,10,10),this.Hi=200,this.Li=4,this.Vi={x:0,y:0},this.Xi={x:0,y:0},this.Yi={x:0,y:0},this.pi=h.pi,this._i=null;var s=new n({ct:Q.o.h,M:19,ot:20,st:10,nt:10});this.Kt(s),this.ct=s,this.qi=!0,this.Gi=!0,this.Ui=0}function O(t,i){a.call(this),this.Ji=t,this.N=i,this.Ki=[]}function I(){O.apply(this,arguments),this.Zi=[],this.$i=[],this.th=[],this.ih=[],this.hh={},this.sh={nh:60,eh:70,rh:60,oh:70},this.Ri=W.D(this.sh.nh,this.sh.eh),this.Ai=W.D(this.sh.rh,this.sh.oh);var t=new T({M:w.width,ot:w.height,ut:"#333333"});if(this.Kt(t),this.pi=new N,this.Kt(this.pi),this.pi.uh(this.Ri,this.Ai),this.pi.ah(),this.pi.ch(),this.pi.tt=2,this.pi.it=2,this.fh=new a({x:w.width/2,y:w.height/2}),this.Kt(this.fh),this.lh(),this.wh=!1,this.wh){var i=this.pi.Ri*this.pi.xi,h=this.pi.Ai*this.pi.xi;i/h>w.width/w.height?this.pi.tt=this.pi.it=w.width/i:this.pi.tt=this.pi.it=w.height/h,this.pi.ji.forEach(function(t){t.ri.ht=!1}),this.pi.Fi[0].ri.ht=!1}var s=this.vh=new k(this,{pi:this.pi});this.pi.Kt(this.vh);var n=this.pi.Qi;this.vh.x=(n.left+n.right)/2*this.pi.xi,this.vh.y=(n.top+n.bottom)/2*this.pi.xi,this.vh.dh(),this.keys=[],this.ph=e(e.keys.m,function(){s.yh(N.mh.left)},function(){s.Mh(N.mh.left)}),this.keys.push(this.ph),this.bh=e(e.keys.b,function(){s.yh(N.mh.bottom)},function(){s.Mh(N.mh.bottom)}),this.keys.push(this.bh),this.xh=e(e.keys.g,function(){s.yh(N.mh.right)},function(){s.Mh(N.mh.right)}),this.keys.push(this.xh),this.gh=e(e.keys.M,function(){s.yh(N.mh.top)},function(){s.Mh(N.mh.top)}),this.keys.push(this.gh);this.kh(this.Oh.bind(this))}function C(t,i){return t.concat(i.si.filter(function(t){return t.hi===N.Ch.Ih||t.hi===N.Ch.Ph}))}function P(t){t.ui=!0}function D(t){var i=new a;return i.Kt(new f({x:150,y:0,vt:[{x:20,y:0},{x:-15,y:-10},{x:-15,y:10}],ut:t})),i}function R(){O.apply(this,arguments),this.i=[],this.Dh=!1,this.Rh=new c({x:w.width/2,y:w.height/2,ft:"0%",ut:"black",lt:"center",wt:"middle",font:"32px Arial"});this.Kt(new T({M:w.width,ot:w.height,ut:"#777777"})),this.Kt(this.Rh)}function A(){this.Yt=this.Yt.bind(this),this.Ah=o.a("root");var t=o.create("canvas");t.width=w.width,t.height=w.height,this.Ah.appendChild(t),this.jh=Q,this.dt=t,this.pt=t.getContext("2d"),this.pt.font="16px Arial",this.Fh=new u,u.qt=this.Fh,this.yi=new R(this),this.Z=0,this.Qh=this.Qh.bind(this),r.addEventListener("resize",this.Sh.bind(this),!1),this.Sh(),this.Yt(0),this.yi.create()}Q.o.n=M.dt,Q.o.r=b.dt,Q.o.e=x.dt,z.prototype={},g.ai=0,g.li=5,g.prototype={zh:function(h,t){var s=t/360*Math.PI*2;this.wi.forEach(function(t){var i=S.z({x:t.x-h.x,y:t.y-h.y},s);t.x=h.x+i.x,t.y=h.y+i.y,t.angle=s}),this.fi.Rt(h,t)},Eh:function(t){if(this.ui=!1,this.wi.forEach(function(t){t.ut="red",null===this.pi&&(this.pi=t.et)},this),-1===this.vi){var i=new T({x:t.x,y:t.y,M:20,ot:10,ut:"#eeeeee",st:10,nt:5,angle:W.P(0,2*Math.PI)});this.pi.Kt(i);var h=new p({H:i,L:"x",from:t.x,V:this.fi.x,X:.5,Y:p.q.zt}),s=new p({H:i,L:"y",from:t.y,V:this.fi.y,X:.5,Y:p.q.zt,G:function(){this.pi.Zt(i)}.bind(this)}),n=new p({H:i,L:"angle",from:i.angle,V:i.angle+W.P(-Math.PI,Math.PI),X:.5});u.qt.Gt(h),u.qt.Gt(s),u.qt.Gt(n),-1!==this.di&&this.Mi&&this.Mi(this)}else this.mi&&this.mi(this)}},N.Wh={Bh:1,Th:2,Nh:3,Hh:4},N.Lh=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:0,y:0},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],N.Vh={Xh:1,Yh:2,_h:3,qh:4,Gh:5},N.Ch={Ih:1,Ph:2,Uh:3,Jh:4,Kh:5},N.mh={right:1,bottom:2,left:4,top:8},N.Zh={width:40,$h:20,ts:20,hi:N.Ch.Ih},N.hs={width:85,$h:20,ts:20,ss:5,hi:N.Ch.Ph},N.ns={width:80,$h:20,ts:20,ss:10,hi:N.Ch.Ih},N.es={width:40,$h:20,ts:20,hi:N.Ch.Ih},N.li=5,N.prototype=t(a.prototype,{uh:function(t,i){var h,s,n,e,r,o,u=t,a=i;for(this.Wi.$t(u*this.xi,a*this.xi),this.Wi.Kt(new T({x:0*this.xi,y:0*this.xi,M:u*this.xi,ot:a*this.xi,ut:Q.u.r})),this.Wi.Kt(new T({x:1*this.xi,y:1*this.xi,M:(u-2)*this.xi,ot:(a-2)*this.xi,ut:Q.u.n})),this.Ri=u,this.Ai=a,h=0;h<u;h+=1)this.rs(h,0,N.Wh.Th),this.rs(h,a-1,N.Wh.Th);for(h=0;h<a;h+=1)this.rs(0,h,N.Wh.Th),this.rs(u-1,h,N.Wh.Th);for(var c,f,l,w,v,d,p,y=W.D(0,2),m={left:1,top:1,right:u-1,bottom:a-1,os:y},M=[m],b=[],x=[],g=0,k=0,O=this.ki,I=this.Oi,C=this.gi;0<M.length&&g<1e4;)if(f=E({},m=M.shift()),l=null,p=0===(y=m.os)?(d="right","left"):(d="bottom","top"),0===k?(v=E({},m),3,l=E({},m),c=W.D(m[p]+O/2,m[d]-O/2),f[d]=c-this.Di/2-1,l[p]=c+this.Di/2+1,v[d]=c+this.Di/2,v[p]=c-this.Di/2,v.us=!0,b.push(v)):(l=E({},m),c=W.D(m[p]+O/2,m[d]-O/2),f[d]=c,l[p]=c+1),n=f.right-f.left,e=f.bottom-f.top,O<n&&I<e&&C<n*e?(f.os=0===k?y?0:1:e<n?0:1,M.push(f)):x.push(f),l&&(n=l.right-l.left,e=l.bottom-l.top,O<n&&I<e&&I<n*e?(l.os=0===k?y?0:1:e<n?0:1,M.push(l)):x.push(l)),g+=1,0===k&&0===M.length)for(k+=1,O=this.Ci,I=this.Pi,C=this.Ii,h=x.length-1;0<=h;h-=1)n=(f=x[h]).right-f.left,e=f.bottom-f.top,O<n&&I<e&&C<n*e&&(f.os=e<n?0:1,M.push(f),x.splice(h,1));if(1e4<=g)throw new Error("Infinite loop in partitioning");for(this.Fi=b,h=0;h<b.length;h+=1)for(n=(v=b[h]).left;n<v.right;n+=1)for(e=v.top;e<v.bottom;e+=1)this.rs(n,e,N.Wh.Bh,v);var P,D=[];for(h=0;h<x.length;h+=1){for(m=x[h],this.Wi.Kt(new T({x:(m.left-1)*this.xi,y:(m.top-1)*this.xi,M:(m.right-m.left+2)*this.xi,ot:(m.bottom-m.top+2)*this.xi,ut:Q.u.r})),this.Wi.Kt(new T({x:m.left*this.xi,y:m.top*this.xi,M:(m.right-m.left)*this.xi,ot:(m.bottom-m.top)*this.xi,ut:Q.u.e})),n=m.left-1;n<m.right+1;n+=1)this.rs(n,m.top-1,N.Wh.Th),this.rs(n,m.bottom,N.Wh.Th);for(e=m.top-1;e<m.bottom+1;e+=1)this.rs(m.left-1,e,N.Wh.Th),this.rs(m.right,e,N.Wh.Th);for(w=new z(this.Ei++,m),n=m.left;n<m.right;n+=1)for(e=m.top;e<m.bottom;e+=1)this.rs(n,e,N.Wh.Hh,w);D.push(w)}for(g=0;0<D.length&&g<1e4;){M=g<x.length?b:this.ji;var R=[];for((P=E({},m=D.shift())).top+=1,P.bottom-=1,P.left-=2,P.right+=2,s=0;s<M.length;s+=1)f=M[s],S.F(P,f)&&R.push(f);for(P.left=m.left+1,P.right=m.right-1,P.top=m.top-2,P.bottom=m.bottom+2,s=0;s<M.length;s+=1)f=M[s],R.indexOf(f)<0&&S.F(P,f)&&R.push(f);if(0<R.length){var A=0;f=W.R(R),P.left=m.left,P.top=m.top,P.right=m.right,P.bottom=m.bottom;var j=!1;P.left-=2,S.F(P,f)&&(j=!0,r=n=f.right,o=(e=W.D(Math.max(m.top,f.top),Math.min(m.bottom,f.bottom)-1))+1,A=N.mh.left),j||(P.left=m.left,P.top-=2,S.F(P,f)&&(j=!0,r=(n=W.D(Math.max(m.left,f.left),Math.min(m.right,f.right)-1))+1,o=e=f.bottom,A=N.mh.top)),j||(P.top=m.top,P.right+=2,S.F(P,f)&&(j=!0,r=n=f.left-1,o=(e=W.D(Math.max(m.top,f.top),Math.min(m.bottom,f.bottom)-1))+1,A=N.mh.right)),j||(r=(n=W.D(Math.max(m.left,f.left),Math.min(m.right,f.right)-1))+1,o=e=f.top-1,A=N.mh.bottom),this.rs(n,e,N.Wh.Nh),this.rs(r,o,N.Wh.Nh),m.ei=!0,this.ji.push(m),m.oi||(m.oi=0),f.oi||(f.oi=0),m.oi|=A;var F=A<<2;8<F&&(F>>=4),f.oi|=F}else m.ei=!1,D.push(m);g+=1}if(1e4<=g)throw new Error("Infinite loop in door placements")},ch:function(){var t,i,h,s=this.Fi;for(h=0;h<this.ji.length;h+=1)i=this.ji[h],t=new T({x:Math.floor((i.left-.5)*this.xi),y:Math.floor((i.top-.5)*this.xi),M:Math.floor((i.right-i.left+1)*this.xi),ot:Math.floor((i.bottom-i.top+1)*this.xi)}),this.Kt(t),i.ri=t;var n=new a;for(this.Kt(n),h=0;h<s.length;h+=1)i=s[h],t=new T({x:Math.floor((i.left-.5)*this.xi),y:Math.floor((i.top-.5)*this.xi),M:Math.floor((i.right-i.left+1)*this.xi),ot:Math.floor((i.bottom-i.top+1)*this.xi)}),n.Kt(t),i.ri=n},ah:function(){var t,i,h=this.ji.slice(),s=W.A(h);for(s.hi=N.Vh.Xh,this.as(s),this.Qi=s;0<h.length;)t=[],200<(i=((s=W.A(h)).right-s.left)*(s.bottom-s.top))&&t.push(N.Vh._h),100<=i&&t.push(N.Vh.Gh),i<100&&t.push(N.Vh.qh),100<=i&&(0===this.Si.length||Math.random()<.1)&&t.push(N.Vh.Yh),s.hi=W.R(t),s.hi===N.Vh.Yh&&this.Si.push(s),this.as(s)},cs:function(i,h,t,s){var n,e,r=s.width/2,o=s.$h/2,u=s.ts/2,a=[];if(n=[new B(i-o-u/2,h,o+u/2,r)],s.hi===N.Ch.Ph){var c=(s.width-s.ss)/2;a.push(new g(s.hi,i-o,h-c/2-s.ss/2,s.$h,c,s.ts)),a.push(new g(s.hi,i-o,h+c/2+s.ss/2,s.$h,c,s.ts))}else a.push(new g(s.hi,i-o,h,s.$h,s.width,s.ts));return e=t===N.mh.left?180:t===N.mh.top?270:t===N.mh.right?0:90,n.forEach(function(t){t.Rt({x:i,y:h},e)}),a.forEach(function(t){t.zh({x:i,y:h},e)}),[n,a]},as:function(i){var t=null,h={left:i.left*this.xi,top:i.top*this.xi,right:i.right*this.xi,bottom:i.bottom*this.xi};i.oi&N.mh.left&&(h.left+=1.5*this.xi),i.oi&N.mh.top&&(h.top+=1.5*this.xi),i.oi&N.mh.right&&(h.right-=1.5*this.xi),i.oi&N.mh.bottom&&(h.bottom-=1.5*this.xi);var s=new T({x:h.left,y:h.top,M:h.right-h.left,ot:h.bottom-h.top,ut:"#007700"});this.Kt(s),i.hi===N.Vh.Gh?t=this.fs(h):i.hi===N.Vh.qh?t=this.ls(h,i):i.hi===N.Vh._h?t=this.ws(h,i):i.hi===N.Vh.Yh&&(t=this.vs(h,i)),t&&(i.ni=t[0],i.si=t[1]),i.si.forEach(function(t){t.ci=i,t.wi.forEach(function(t){this.Kt(t)},this)},this);var n=(i.left+i.right)/2*this.xi,e=(i.top+i.bottom)/2*this.xi,r=new c({ft:["Unknown","Mailroom","Lobby","Bullpen","Private","Open"][i.hi],x:n,y:e,lt:"center",wt:"middle",font:"36px Arial"});this.Kt(r)},fs:function(t,i){var h,s,n=t.right-t.left,e=t.bottom-t.top,r=[],o=[],u=[N.Zh],a=e<n?e:n;N.hs.width+100>=a&&u.push(N.hs);var c,f,l,w,v,d=W.R(u),p=d.$h+50,y=d.width/2,m=d.ts/2,M=W.D(0,2);if(e<n){for(l=Math.floor(n/p),w=Math.random()*(n-l*p),f=t.top+y;f+y<t.bottom;){for(h=0;h<l;h+=1)c=t.left+h*p+M*(d.$h+m)+w,s=this.cs(c,f,M?N.mh.right:N.mh.left,d),r=r.concat(s[0]),o=o.concat(s[1]);f+=50+d.width}var b=null,x=null;r.forEach(function(t){(!b||t.y<b.y)&&(b=t),(!x||t.y>x.y)&&(x=t)}),b&&x?(v=Math.random()*(e-(x.y+x.T-(b.y-b.T))),r.forEach(function(t){t.y+=v}),o.forEach(function(t){t.wi.forEach(function(t){t.y+=v}),t.fi.y+=v})):console.log("Empty room")}else{for(l=Math.floor(e/p),w=Math.random()*(e-l*p),c=t.left+y;c+y<t.right;){for(h=0;h<l;h+=1)f=t.top+h*p+M*(d.$h+m)+w,s=this.cs(c,f,M?N.mh.bottom:N.mh.top,d),r=r.concat(s[0]),o=o.concat(s[1]);c+=50+d.width}var g=null,k=null;r.forEach(function(t){(!g||t.x<g.x)&&(g=t),(!k||t.x>k.x)&&(k=t)}),k&&g?(v=Math.random()*(n-(k.x+k.B-(g.x-g.B))),r.forEach(function(t){t.x+=v}),o.forEach(function(t){t.wi.forEach(function(t){t.x+=v}),t.fi.x+=v})):console.log("Empty room")}return[r,o]},ls:function(t,i){var h,s,n,e,r=this.ds(i),o=N.ns,u=o.$h+o.ts/2,a=o.width/2,c=u+o.ss;return r===N.mh.left||r===N.mh.right?(n=t.top+a,s=(e=t.bottom-a)<=n?(t.top+t.bottom)/2:W.P(n,e)):(n=t.left+a,h=(e=t.right-a)<=n?(t.left+t.right)/2:W.P(n,e)),r===N.mh.right?h=t.left+c:r===N.mh.left?h=t.right-c:s=r===N.mh.bottom?t.top+c:t.bottom-c,this.cs(h,s,r,o)},ws:function(t,i){var h,s,n,e=t.right-t.left,r=t.bottom-t.top;n=r<e?(h=e,s=r,0):(h=r,s=e,1);var o,u,a,c,f,l,w,v,d,p,y,m,M=Math.floor((s-30)/130),b=Math.floor((h-30)/280),x=(s-30)%130-30,g=(h-30)%280-30,k=Math.floor(x/50),O=Math.floor(g/50),I=[],C=[];0<k&&(M+=1),0<O&&(b+=1);var P=[],D=[];for(o=0;o<M;o+=1)for(l=130*o+30,d=0<k&&o===M-1?k:2,u=0;u<b;u+=1)for(m=new B((f=280*u+30)+50*(p=0<O&&u===b-1?O:5)/2,l+50,50*p/2,2),D.push(m),a=0;a<d;a+=1){for(v=l+50*a,y=a%2==0?N.mh.top:N.mh.bottom,c=0;c<p;c+=1)(m=new B((w=f+50*c)+25,v+25,25,25)).ps=y,P.push(m),m=new B(w,v+25,2,25),D.push(m);m=new B(f+50*p,v+25,2,25),D.push(m)}var R,A,j=(t.left+t.right)/2,F=(t.top+t.bottom)/2,Q={x:h/2,y:s/2},S=j-Q.x,z=F-Q.y;return R=0===n?[0,180]:[90,270],A=W.R(R),P.forEach(function(t){if(0!==A){t.Rt(Q,A);var i,h=Math.round(A/90);for(i=0;i<h;i+=1)t.ps<<=1,8<t.ps&&(t.ps=1)}t.x+=S,t.y+=z;var s,n,e=W.j(15^t.ps);n=e===N.mh.right?(s=t.x+t.B,t.y):e===N.mh.bottom?(s=t.x,t.y+t.T):e===N.mh.left?(s=t.x-t.B,t.y):(s=t.x,t.y-t.T);var r=this.cs(s,n,e,N.es);I=I.concat(r[0]),C=C.concat(r[1])},this),D.forEach(function(t){0!==A&&t.Rt(Q,A),t.x+=S,t.y+=z,I.push(t.Pt()),C.push({ci:null,hi:N.Ch.Kh,wi:[new T(E(t.jt(),{ut:"black"}))]})}),[I,C]},vs:function(t,i){this.ds(i);return[[],[]]},ds:function(t){var i,h,s=0,n=[];for(i=1;i<=8&&!s;i<<=1)i===t.oi?s=i:0<(t.oi&i)&&n.push(i);if(s||(5===t.oi?s=W.R([1,4]):10===t.oi&&(s=W.R([2,8]))),!s)for(h=1;h<=8&&!s;h<<=1)i=h,i|=8<h<<1?1:h<<1,(i|=h>>1<1?8:h>>1)===t.oi&&(s=h);return s||(s=W.R(n)),s},ys:function(t,i,h,s){var n=null,e=null,r=this.xi/2,o=null,u=!0;switch(h){case N.Wh.Th:e=new B(t*this.xi+r,i*this.xi+r,r,r),u=!1;break;case N.Wh.Bh:u=!0;break;case N.Wh.Nh:n="#00aa00",u=!0;break;case N.Wh.Hh:u=!0}return n&&(o=new T({x:t*this.xi,y:i*this.xi,M:this.xi,ot:this.xi,ut:n})),{hi:h,ms:o,Bi:e,ci:s,Ms:u}},bs:function(t,i){return this.bi[t]&&this.bi[t][i]?this.bi[t][i]:null},rs:function(t,i,h,s){this.bi[t]||(this.bi[t]={});var n=this.bi[t][i];n&&n.ms&&this.Zt(n.ms),n=this.ys(t,i,h,s),(this.bi[t][i]=n).ms&&this.Kt(n.ms)},xs:function(t,i){return this.bs(Math.floor(t/this.xi),Math.floor(i/this.xi))},gs:function(t,i){var h,s,n=[],e=Math.floor(t/this.xi),r=Math.floor(i/this.xi),o=null,u=N.Lh;for(s=0;s<u.length;s+=1)h=u[s],(o=this.bs(e+h.x,r+h.y))&&n.push(o);return n}}),k.prototype=t(a.prototype,{yh:function(t){this.Ui|=t,this.ks()},Mh:function(t){this.Ui^=t,this.ks()},ks:function(){this.Vi.x=0,this.Vi.y=0,this.Ui&N.mh.left&&(this.Vi.x-=this.Hi),this.Ui&N.mh.right&&(this.Vi.x+=this.Hi),this.Ui&N.mh.top&&(this.Vi.y-=this.Hi),this.Ui&N.mh.bottom&&(this.Vi.y+=this.Hi)},dh:function(){this.Ti.mt(this.Bi.x,this.Bi.y),this.Bi.mt(this.x,this.y)},Yt:function(t){var i,h,s,n,e,r,o=1,u=0,a=0;s=this.pi.xs(this.x,this.y),this.ks(),(this.Vi.x||this.Vi.y)&&(this.ct.angle=S.Q(this.Vi));var c=null;for(this.Gi&&s&&s.ci&&s.ci.ni&&(c=s.ci.ni),e=0;e<this.Li;e+=1){if(o=1,c)for(this.Os(t),h=0;h<c.length;h+=1)(n=this.Is(c[h],t))<o&&(o=n,u=this.Yi.x,a=this.Yi.y);this.x+=this.Vi.x*t*o/this.Li,this.y+=this.Vi.y*t*o/this.Li,o<1&&(r=(this.Vi.x*a+this.Vi.y*u)*(1-o),this.Vi.x=r*a,this.Vi.y=r*u),this.dh()}if(o<1&&(r=(this.Vi.x*a+this.Vi.y*u)*(1-o),this.x+=r*a*t/this.Li,this.y+=r*u*t/this.Li,this.dh()),s&&s.ci&&s.ci.si){var f=s.ci.si,l=!1;for(h=0;h<f.length;h+=1)if(f[h].hi===N.Ch.Ih||f[h].hi===N.Ch.Ph){var w=f[h];w.ui&&w.fi.It(this.Bi)&&w.Eh(this),l=l||w.ui}s.ci.ui=l}if(this.qi)for(i=this.pi.gs(this.x,this.y),h=0;h<i.length;h+=1)!(s=i[h]).Ms&&s.Bi&&this.Cs(s.Bi);if((s=this.pi.xs(this.x,this.y))&&s.ci&&this._i!==s.ci){var v=this._i;if(this._i=s.ci,v&&(!v.us||!this._i.us)){v.Ps&&(v.Ps._t(),v.Ps=null);var d=new p({H:v.ri,L:"alpha",from:0,V:1,X:.5});v.Ps=d,this.yi.Ji.Fh.Gt(d)}this._i.Ps&&(this._i.Ps._t(),this._i.Ps=null),this._i.ri.alpha=0}},Cs:function(t){var i,h;t.It(this.Bi)&&(i=this.Bi.x-t.x,h=this.Bi.y-t.y,Math.abs(i)>Math.abs(h)?this.x=0<i?t.xt()+this.Bi.B+1:t.Mt()-this.Bi.B-1:this.y=0<h?t.gt()+this.Bi.T+1:t.bt()-this.Bi.T-1,this.dh())},Is:function(t,i){if(!this.Ni.It(t))return this.Yi.x=0,this.Yi.y=0,1;var h,s,n,e,r,o,u,a;n=0<this.Vi.x?(h=t.x-t.B-(this.Bi.x+this.Bi.B),t.x+t.B-(this.Bi.x-this.Bi.B)):(h=t.x+t.B-(this.Bi.x-this.Bi.B),t.x-t.B-(this.Bi.x+this.Bi.B)),e=0<this.Vi.y?(s=t.y-t.T-(this.Bi.y+this.Bi.T),t.y+t.T-(this.Bi.y-this.Bi.T)):(s=t.y+t.T-(this.Bi.y-this.Bi.T),t.y-t.T-(this.Bi.y+this.Bi.T)),u=0===this.Vi.x?(r=-Number.MAX_VALUE,Number.MAX_VALUE):(r=h/(this.Vi.x*i/this.Li),n/(this.Vi.x*i/this.Li)),a=0===this.Vi.y?(o=-Number.MAX_VALUE,Number.MAX_VALUE):(o=s/(this.Vi.y*i/this.Li),e/(this.Vi.y*i/this.Li));var c=Math.max(r,o);return Math.min(u,a)<c||r<0&&o<0||1<r||1<o?(this.Yi.x=0,this.Yi.y=0,1):(o<r?(this.Yi.x=h<0?1:-1,this.Yi.y=0):(this.Yi.x=0,this.Yi.y=s<0?1:-1),c)},Os:function(t){var i=this.Vi.x*t/this.Li,h=this.Vi.y*t/this.Li,s=0<this.Vi.x?this.Bi.x-this.Bi.B:this.Bi.x-this.Bi.B+i,n=0<this.Vi.y?this.Bi.y-this.Bi.T:this.Bi.y-this.Bi.T+h,e=0<this.Vi.x?this.Bi.x+this.Bi.B+i:this.Bi.x+this.Bi.B,r=0<this.Vi.y?this.Bi.y+this.Bi.T+h:this.Bi.y+this.Bi.T;this.Ni.x=(s+e)/2,this.Ni.y=(n+r)/2,this.Ni.B=(e-s)/2,this.Ni.T=(r-n)/2}}),O.prototype=t(a.prototype,{create:function(){},p:function(){},kh:function(t){this.Ki.push(t)},Yt:function(t){for(var i=0;i<this.Ki.length;i+=1)this.Ki[i](t)},Ut:function(t){this.Jt(t)}}),I.prototype=t(O.prototype,{p:function(){this.keys.forEach(function(t){t.p()})},Oh:function(t){this.vh.Yt(t),this.wh||(this.pi.x=Math.floor(w.width/2-this.vh.x*this.pi.tt),this.pi.y=Math.floor(w.height/2-this.vh.y*this.pi.it)),this.Ds()},Ds:function(){var t,i,h,s,n,e;for(t=0;t<this.Zi.length;t+=1)(i=this.Zi[t]).ui&&(e=this.hh[i.ii],this.vh._i!==i?(e.ht=!0,h=(i.left+i.right)/2*this.pi.xi,s=(i.top+i.bottom)/2*this.pi.xi,n=Math.atan2(s-this.vh.y,h-this.vh.x),e.angle=n):e.ht=!1)},lh:function(){var t,i,h,s=this.pi.ji.filter(function(t){return t.si&&t.si.length&&t.si.some(function(t){return t.hi===N.Ch.Ih||t.hi===N.Ch.Ph})}),n=W.D(w.minMailableRooms,Math.max(w.minMailableRooms+1,Math.floor(s.length*w.maxMailableRoomRate))),e=[];for(t=0;t<n;t+=1)i=W.A(s),h=D("white"),this.fh.Kt(h),this.hh[i.ii]=h,i.ui=!0,e.push(i);var r=e.reduce(C,[]),o=s.reduce(C,[]),u=W.D(w.minMissingPeople,w.maxMissingPeople+1);u>r.length&&(u=r.length);var a,c,f=[],l=[];for(t=0;t<u;t+=1)a=W.A(r),c=W.A(o),a.vi=c.ii,c.di=a.ii,f.push(a),l.push(c),a.mi=this.Rs.bind(this),c.Mi=this.As.bind(this);r.forEach(P),f.forEach(P),l.forEach(P),this.Zi=e,this.$i=r,this.th=f,this.ih=l,this.$i.forEach(function(t){t.wi.forEach(function(t){t.ut="white"})}),this.th.forEach(function(t){t.wi.forEach(function(t){t.ut="blue"})}),this.ih.forEach(function(t){t.wi.forEach(function(t){t.ut="gray"})})},Rs:function(i){var t=this.ih.find(function(t){return t.ii===i.vi});if(t){if(t.ui&&-1===this.Zi.indexOf(t.ci)){t.ci.ui=!0,this.Zi.push(t.ci);var h=D("blue");this.hh[t.ci.ii]=h,this.fh.Kt(h)}}else console.log("desk "+i.vi+" not found")},As:function(i){var t=this.th.find(function(t){return t.ii===i.di});t&&t.ui&&t.Eh(this.vh)}}),R.prototype=t(O.prototype,{create:function(){Object.entries(Q.i).forEach(function(t){var i=new Image;i.onload=this.js.bind(this),i.src=t[1],this.i.push(i),Q.o[t[0]]=i},this)},js:function(t){if(!this.Dh){var i=this.i.reduce(function(t,i){return(i.complete?1:0)+(t||0)},0);this.Rh.ft=Math.floor(i/this.i.length*100)+"%",i>=this.i.length&&this.Fs()}},Fs:function(){this.Dh||(Object.entries(Q.s).forEach(function(t){Q.u[t[0]]=this.Ji.pt.createPattern(Q.o[t[0]],t[1])},this),this.Dh=!0,this.Ji.Qs(new I(this.Ji)))}}),A.prototype={Sh:function(){this.Qh(),setTimeout(function(){this.Qh()}.bind(this),100)},Qh:function(){var t,i,h=r.getComputedStyle(o.a("root")),s=parseInt(h.width,10),n=parseInt(h.height,10),e=this.dt.width/this.dt.height;s/n<e?i=(t=s)/e:t=(i=n)*e,this.dt.style.width=Math.floor(t)+"px",this.dt.style.height=Math.floor(i)+"px",this.dt.style.position="absolute",this.dt.style.left="50%",this.dt.style.top="50%",this.dt.style.marginLeft=Math.floor(-t/2)+"px",this.dt.style.marginTop=Math.floor(-i/2)+"px"},Qs:function(t){this.yi&&this.yi.p(),(this.yi=t).create()},Yt:function(t){var i=(t-this.Z)/1e3;0<i&&(.2<i&&(i=.2),this.yi.Yt(i),this.yi.Ut(this.pt),this.Fh.Yt(i),this.Z=t),requestAnimationFrame(this.Yt)}},r.game=new A}(window,document);