!function(r,i){var d={t:"Mail Delivery",width:640,height:360,minMailableRooms:2,maxMailableRoomRate:.25,minMissingPeople:5,maxMissingPeople:10},F={i:{h:"robot_3Dblue.png",s:"grassCenter.png",n:"stoneCenter.png",e:"roofGreyMid.png"},r:{s:"repeat",n:"repeat",e:"repeat"},o:{},u:{}};function z(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(t),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var e in n)Object.prototype.hasOwnProperty.call(n,e)&&(h[e]=n[e])}return h}function t(){return z.apply(this,[{}].concat(Array.prototype.slice.call(arguments)))}var h,o=(h={},{a:function(t){return h[t]||(h[t]=i.getElementById(t)),h[t]},create:function(t){return i.createElement(t)}});function e(t,i,h){var s={c:t,f:!1,l:i,d:h,v:function(t){t.keyCode===s.c&&(!s.f&&s.l&&s.l(),s.f=!0),t.preventDefault()},w:function(t){t.keyCode===s.c&&(s.f&&s.d&&s.d(),s.f=!1),t.preventDefault()},p:function(){r.removeEventListener("keydown",s.v,!1),r.removeEventListener("keyup",s.w,!1)}};return r.addEventListener("keydown",s.v,!1),r.addEventListener("keyup",s.w,!1),s}e.keys={M:65,m:87,b:83,g:68,left:37,k:38,right:39,I:40,O:32,C:13};var E=null;E={D:function(t,i){return t+Math.random()*(i-t)},R:function(t,i){return Math.floor(E.D(t,i))},A:function(t){return t[E.R(0,t.length)]},P:function(t){var i=E.R(0,t.length),h=t[i];return t.splice(i,1),h}};var S={j:function(t,i){return t.left<i.right&&t.right>i.left&&t.top<i.bottom&&t.bottom>i.top},Q:function(t){return Math.atan2(t.y,t.x)},F:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},z:function(t,i){var h=Math.cos(i),s=Math.sin(i);return{x:t.x*h-t.y*s,y:t.x*s+t.y*h}},S:function(t,i,h){if(0===h)return{left:t.left,top:t.top,right:t.right,bottom:t.bottom};var s,n,e=t.right-t.left,r=t.bottom-t.top,o=h/360*Math.PI*2;return 90!==h&&270!==h||(n=e,e=r,r=n),(s=90===h?{x:t.left,y:t.bottom}:180===h?{x:t.right,y:t.bottom}:{x:t.right,y:t.top}).x-=i.x,s.y-=i.y,s=S.z(s,o),{left:i.x+s.x,top:i.y+s.y,right:i.x+s.x+e,bottom:i.y+s.y+r}}};function f(t,i,h,s){this.x=t||0,this.y=i||0,this.W=h||0,this.B=s||0}function c(t){this.H=z({V:null,X:null,from:0,Y:1,L:1,T:c.G._,q:null},t||{}),this.N=-1,this.U=-1,this.J=!1}function u(){this.K=0,this.Z=[]}function s(t){var i=z({x:0,y:0,$:1,tt:1,angle:0,it:!0,alpha:1,ht:0,st:0},t||{});this.nt=null,this.x=i.x,this.y=i.y,this.$=i.$,this.tt=i.tt,this.angle=i.angle,this.it=i.it,this.alpha=i.alpha,this.ht=i.ht,this.st=i.st}function a(t){s.apply(this,arguments),this.et=[]}function W(t){s.apply(this,arguments);var i=z({m:0,rt:0,ot:"black"},t||{});this.m=i.m,this.rt=i.rt,this.ot=i.ot}function n(t){s.apply(this,arguments);var i=z({m:0,rt:0,ut:null},t||{});this.m=i.m,this.rt=i.rt,this.ut=i.ut,this.m&&!i.$&&(this.$=this.m/this.ut.width),this.rt&&!i.tt&&(this.tt=this.rt/this.ut.height)}function l(t){s.apply(this,arguments);var i=z({at:"",ct:"left",ft:"top",font:null,ot:"black"},t||{});this.ot=i.ot,this.at=i.at,this.ct=i.ct,this.ft=i.ft,this.font=i.font}function v(t){s.apply(this,arguments);var i=z({lt:[],ot:"black"},t||{});this.lt=i.lt,this.ot=i.ot}function w(t){a.apply(this,arguments);var i=z({m:100,rt:100},t||{});this.dt=o.create("canvas"),this.dt.width=i.m,this.dt.height=i.rt,this.vt=this.dt.getContext("2d")}function B(t,i){this.wt=t,this.left=i.left,this.top=i.top,this.right=i.right,this.bottom=i.bottom,this.pt=0,this.yt=[],this.Mt=[],this.mt=!1,this.xt=null,this.bt=0,this.gt=!1}function p(t,i,h,s,n,e,r){this.wt=p.kt++,this.pt=t,this.It=r,this.Ot=new f(i,h,s/2+p.Ct,n/2+p.Ct),this.Dt=[new W({x:i-s/2,y:h-n/2,m:s,rt:n,ot:"#990000"}),new W({x:i-s/2-e/2,y:h-e/2,m:e,rt:e,ot:"#990000"})],this.gt=!1,this.Rt=-1,this.At=-1,this.Pt=null,this.jt=null,this.Qt=null,this.Ft=null}function H(){a.apply(this,arguments),this.zt={},this.Et=20,this.St=1e3,this.Wt=20,this.Bt=20,this.Ht=100,this.Vt=12,this.Xt=12,this.Yt=2,this.Lt=0,this.Tt=0,this._t=[],this.Gt=[],this.qt=null,this.Nt=[],this.Ut=0,this.Jt=0,this.Kt=new w,this.Zt(this.Kt)}function y(t,i){a.call(this,i),this.jt=t;var h=z({Pt:null},i||{});this.$t=new f(0,0,10,10),this.ti=new f(0,0,10,10),this.ii=200,this.hi={x:0,y:0},this.Pt=h.Pt,this.si=null;var s=new n({ut:F.o.h,m:19,rt:20,ht:10,st:10});this.Zt(s),this.ut=s,this.ni=!0,this.ei=!0,this.ri=0}function M(t,i){a.call(this),this.oi=t,this.H=i,this.ui=[]}function m(){M.apply(this,arguments),this.ai=[],this.ci=[],this.fi=[],this.li=[],this.di={},this.vi={wi:60,pi:70,yi:60,Mi:70},this.Lt=E.R(this.vi.wi,this.vi.pi),this.Tt=E.R(this.vi.yi,this.vi.Mi);var t=new W({m:d.width,rt:d.height,ot:"#333333"});if(this.Zt(t),this.Pt=new H,this.Zt(this.Pt),this.Pt.mi(this.Lt,this.Tt),this.Pt.xi(),this.Pt.bi(),this.Pt.$=2,this.Pt.tt=2,this.gi=new a({x:d.width/2,y:d.height/2}),this.Zt(this.gi),this.ki(),this.Ii=!1,this.Ii){var i=this.Pt.Lt*this.Pt.Et,h=this.Pt.Tt*this.Pt.Et;i/h>d.width/d.height?this.Pt.$=this.Pt.tt=d.width/i:this.Pt.$=this.Pt.tt=d.height/h,this.Pt._t.forEach(function(t){t.xt.it=!1}),this.Pt.Gt[0].xt.it=!1}var s=this.Oi=new y(this,{Pt:this.Pt});this.Pt.Zt(this.Oi);var n=this.Pt.qt;this.Oi.x=(n.left+n.right)/2*this.Pt.Et,this.Oi.y=(n.top+n.bottom)/2*this.Pt.Et,this.Oi.Ci(),this.keys=[],this.Di=e(e.keys.M,function(){s.Ri(H.Ai.left)},function(){s.Pi(H.Ai.left)}),this.keys.push(this.Di),this.ji=e(e.keys.b,function(){s.Ri(H.Ai.bottom)},function(){s.Pi(H.Ai.bottom)}),this.keys.push(this.ji),this.Qi=e(e.keys.g,function(){s.Ri(H.Ai.right)},function(){s.Pi(H.Ai.right)}),this.keys.push(this.Qi),this.Fi=e(e.keys.m,function(){s.Ri(H.Ai.top)},function(){s.Pi(H.Ai.top)}),this.keys.push(this.Fi),this.zi(this.Ei.bind(this))}function x(t,i){return t.concat(i.yt.filter(function(t){return t.pt===H.Wi.Si||t.pt===H.Wi.Bi}))}function b(t){t.gt=!0}function g(t){var i=new a;return i.Zt(new v({x:150,y:0,lt:[{x:20,y:0},{x:-15,y:-10},{x:-15,y:10}],ot:t})),i}function k(){M.apply(this,arguments),this.i=[],this.Hi=!1,this.Vi=new l({x:d.width/2,y:d.height/2,at:"0%",ot:"black",ct:"center",ft:"middle",font:"32px Arial"});this.Zt(new W({m:d.width,rt:d.height,ot:"#777777"})),this.Zt(this.Vi)}function I(){this.Ei=this.Ei.bind(this),this.Xi=o.a("root");var t=o.create("canvas");t.width=d.width,t.height=d.height,this.Xi.appendChild(t),this.dt=t,this.vt=t.getContext("2d"),this.vt.font="16px Arial",this.Yi=new u,u.Li=this.Yi,this.jt=new k(this),this.K=0,this.Ti=this.Ti.bind(this),r.addEventListener("resize",this._i.bind(this),!1),this._i(),this.Ei(0),this.jt.create()}f.Gi=function(t){return new f((t.left+t.right)/2,(t.top+t.bottom)/2,(t.right-t.left)/2,(t.bottom-t.top)/2)},(f.prototype={}).qi=function(t,i){this.x=t||0,this.y=i||0},f.prototype.Ni=function(){return this.x-this.W},f.prototype.Ui=function(){return this.y-this.B},f.prototype.Ji=function(){return this.x+this.W},f.prototype.Ki=function(){return this.y+this.B},f.prototype.Zi=function(){return 2*this.W},f.prototype.$i=function(){return 2*this.B},f.prototype.th=function(t){return Math.abs(this.x-t.x)<this.W+t.W&&Math.abs(this.y-t.y)<this.B+t.B},f.prototype.ih=function(t,i){return Math.abs(this.x-t)<this.W&&Math.abs(this.y-i)<this.B},f.prototype.hh=function(){return new f(this.x,this.y,this.W,this.B)},f.prototype.sh=function(t){return this.W+=t,this.B+=t,this},f.prototype.nh=function(t,i){var h,s=i/360*Math.PI*2;90!==i&&270!==i||(h=this.W,this.W=this.B,this.B=h);var n=S.z({x:this.x-t.x,y:this.y-t.y},s);return this.x=t.x+n.x,this.y=t.y+n.y,this},f.prototype.eh=function(){return{left:this.x-this.W,top:this.y-this.B,right:this.x+this.W,bottom:this.y+this.B}},c.G={_:function(t){return t},rh:function(t){return t*t},oh:function(t){return t*(2-t)},uh:function(t){return t<.5?2*t*t:(4-2*t)*t-1},ah:function(t){return t*t*t},ch:function(t){return--t*t*t+1},fh:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},lh:function(t){return t*t*t*t},dh:function(t){return 1- --t*t*t*t},vh:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},wh:function(t){return t*t*t*t*t},ph:function(t){return 1+--t*t*t*t*t},yh:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},c.prototype={Mh:function(t){this.N=t,this.U=t+this.H.L},Ei:function(t){if(this.H.V&&this.H.X){var i=(t-this.N)/this.H.L;1<i&&(i=1);var h=this.H.T(i),s=this.H.from+(this.H.Y-this.H.from)*h;this.H.V[this.H.X]=s}},mh:function(){this.J=!0}},u.Li=null,u.prototype={xh:function(t){t.Mh(this.K),this.Z.push(t)},Ei:function(t){var i,h,s;for(i=0;i<this.Z.length;i+=1)s=!1,(h=this.Z[i]).J||h.Ei(this.K),h.J?s=!0:this.K>=h.U&&(h.H.q&&h.H.q(),s=!0),s&&(this.Z.splice(i,1),i-=1);this.K+=t}},a.prototype=t(s.prototype={bh:function(t){this.it&&.01<=this.alpha&&(t.save(),(this.x||this.y)&&t.translate(this.x,this.y),1===this.$&&1===this.tt||t.scale(this.$,this.tt),this.angle&&t.rotate(this.angle),(this.ht||this.st)&&t.translate(-this.ht/this.$,-this.st/this.tt),this.alpha<1&&(t.globalAlpha*=this.alpha),this.gh(t),t.restore())},gh:function(t){}},{Zt:function(t){return this.et.push(t),t.nt=this},kh:function(t){var i=this.et.indexOf(t);return 0<=i&&(this.et.splice(i,1),t.nt=null),this},gh:function(t){for(var i=0;i<this.et.length;i+=1)this.et[i].bh(t)}}),W.prototype=t(s.prototype,{gh:function(t){t.fillStyle=this.ot,t.fillRect(0,0,this.m,this.rt)}}),n.prototype=t(s.prototype,{gh:function(t){t.drawImage(this.ut,0,0)}}),l.prototype=t(s.prototype,{gh:function(t){this.font&&(t.font=this.font),t.textAlign=this.ct,t.textBaseline=this.ft,t.fillStyle=this.ot,t.fillText(this.at,0,0)}}),v.prototype=t(s.prototype,{gh:function(t){var i,h;for(t.beginPath(),i=0;i<this.lt.length;i+=1)h=this.lt[i],0===i?t.moveTo(h.x,h.y):t.lineTo(h.x,h.y);t.closePath(),t.fillStyle=this.ot,t.fill()}}),w.prototype=t(a.prototype,{Ih:function(t,i){this.dt.width=t,this.dt.height=i},Zt:function(t){a.prototype.Zt.apply(this,arguments),this.Oh()},kh:function(t){a.prototype.kh.apply(this,arguments),this.Oh()},Oh:function(){this.vt.clearRect(0,0,this.dt.width,this.dt.height);for(var t=0;t<this.et.length;t+=1)this.et[t].bh(this.vt)},gh:function(t){t.drawImage(this.dt,0,0)}}),B.prototype={},p.kt=0,p.Ct=5,p.prototype={Ch:function(h,t){var s=t/360*Math.PI*2;this.Dt.forEach(function(t){var i=S.z({x:t.x-h.x,y:t.y-h.y},s);t.x=h.x+i.x,t.y=h.y+i.y,t.angle=s}),this.Ot.nh(h,t)},Dh:function(t){if(this.gt=!1,this.Dt.forEach(function(t){t.ot="red",null===this.Pt&&(this.Pt=t.nt)},this),-1===this.Rt){var i=new W({x:t.x,y:t.y,m:20,rt:10,ot:"#eeeeee",ht:10,st:5,angle:E.D(0,2*Math.PI)});this.Pt.Zt(i);var h=new c({V:i,X:"x",from:t.x,Y:this.Ot.x,L:.5,T:c.G.ah}),s=new c({V:i,X:"y",from:t.y,Y:this.Ot.y,L:.5,T:c.G.ah,q:function(){this.Pt.kh(i)}.bind(this)}),n=new c({V:i,X:"angle",from:i.angle,Y:i.angle+E.D(-Math.PI,Math.PI),L:.5});u.Li.xh(h),u.Li.xh(s),u.Li.xh(n),-1!==this.At&&this.Ft&&this.Ft(this)}else this.Qt&&this.Qt(this)}},H.Rh={Ah:1,Ph:2,jh:3,Qh:4},H.Fh=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1},{x:0,y:0},{x:1,y:1},{x:-1,y:1},{x:-1,y:-1},{x:1,y:-1}],H.zh={Eh:1,Sh:2,Wh:3,Bh:4,Hh:5},H.Wi={Si:1,Bi:2,Vh:3,Xh:4},H.Ai={right:1,bottom:2,left:4,top:8},H.Yh={width:40,Lh:20,Th:20,pt:H.Wi.Si},H._h={width:85,Lh:20,Th:20,Gh:5,pt:H.Wi.Bi},H.qh={width:80,Lh:20,Th:20},H.Ct=5,H.prototype=t(a.prototype,{mi:function(t,i){var h,s,n,e,r,o,u=t,a=i;for(this.Kt.Ih(u*this.Et,a*this.Et),this.Kt.Zt(new W({x:0*this.Et,y:0*this.Et,m:u*this.Et,rt:a*this.Et,ot:F.u.e})),this.Kt.Zt(new W({x:1*this.Et,y:1*this.Et,m:(u-2)*this.Et,rt:(a-2)*this.Et,ot:F.u.s})),this.Lt=u,this.Tt=a,h=0;h<u;h+=1)this.Nh(h,0,H.Rh.Ph),this.Nh(h,a-1,H.Rh.Ph);for(h=0;h<a;h+=1)this.Nh(0,h,H.Rh.Ph),this.Nh(u-1,h,H.Rh.Ph);for(var c,f,l,d,v,w,p,y=E.R(0,2),M={left:1,top:1,right:u-1,bottom:a-1,Uh:y},m=[M],x=[],b=[],g=0,k=0,I=this.Wt,O=this.Bt,C=this.St;0<m.length&&g<1e4;)if(f=z({},M=m.shift()),l=null,p=0===(y=M.Uh)?(w="right","left"):(w="bottom","top"),0===k?(v=z({},M),3,l=z({},M),c=E.R(M[p]+I/2,M[w]-I/2),f[w]=c-this.Yt/2-1,l[p]=c+this.Yt/2+1,v[w]=c+this.Yt/2,v[p]=c-this.Yt/2,v.Jh=!0,x.push(v)):(l=z({},M),c=E.R(M[p]+I/2,M[w]-I/2),f[w]=c,l[p]=c+1),n=f.right-f.left,e=f.bottom-f.top,I<n&&O<e&&C<n*e?(f.Uh=0===k?y?0:1:e<n?0:1,m.push(f)):b.push(f),l&&(n=l.right-l.left,e=l.bottom-l.top,I<n&&O<e&&O<n*e?(l.Uh=0===k?y?0:1:e<n?0:1,m.push(l)):b.push(l)),g+=1,0===k&&0===m.length)for(k+=1,I=this.Vt,O=this.Xt,C=this.Ht,h=b.length-1;0<=h;h-=1)n=(f=b[h]).right-f.left,e=f.bottom-f.top,I<n&&O<e&&C<n*e&&(f.Uh=e<n?0:1,m.push(f),b.splice(h,1));if(1e4<=g)throw new Error("Infinite loop in partitioning");for(this.Gt=x,h=0;h<x.length;h+=1)for(n=(v=x[h]).left;n<v.right;n+=1)for(e=v.top;e<v.bottom;e+=1)this.Nh(n,e,H.Rh.Ah,v);var D,R=[];for(h=0;h<b.length;h+=1){for(M=b[h],this.Kt.Zt(new W({x:(M.left-1)*this.Et,y:(M.top-1)*this.Et,m:(M.right-M.left+2)*this.Et,rt:(M.bottom-M.top+2)*this.Et,ot:F.u.e})),this.Kt.Zt(new W({x:M.left*this.Et,y:M.top*this.Et,m:(M.right-M.left)*this.Et,rt:(M.bottom-M.top)*this.Et,ot:F.u.n})),n=M.left-1;n<M.right+1;n+=1)this.Nh(n,M.top-1,H.Rh.Ph),this.Nh(n,M.bottom,H.Rh.Ph);for(e=M.top-1;e<M.bottom+1;e+=1)this.Nh(M.left-1,e,H.Rh.Ph),this.Nh(M.right,e,H.Rh.Ph);for(d=new B(this.Jt++,M),n=M.left;n<M.right;n+=1)for(e=M.top;e<M.bottom;e+=1)this.Nh(n,e,H.Rh.Qh,d);R.push(d)}for(g=0;0<R.length&&g<1e4;){m=g<b.length?x:this._t;var A=[];for((D=z({},M=R.shift())).top+=1,D.bottom-=1,D.left-=2,D.right+=2,s=0;s<m.length;s+=1)f=m[s],S.j(D,f)&&A.push(f);for(D.left=M.left+1,D.right=M.right-1,D.top=M.top-2,D.bottom=M.bottom+2,s=0;s<m.length;s+=1)f=m[s],A.indexOf(f)<0&&S.j(D,f)&&A.push(f);if(0<A.length){var P=0;f=E.A(A),D.left=M.left,D.top=M.top,D.right=M.right,D.bottom=M.bottom;var j=!1;D.left-=2,S.j(D,f)&&(j=!0,r=n=f.right,o=(e=E.R(Math.max(M.top,f.top),Math.min(M.bottom,f.bottom)-1))+1,P=H.Ai.left),j||(D.left=M.left,D.top-=2,S.j(D,f)&&(j=!0,r=(n=E.R(Math.max(M.left,f.left),Math.min(M.right,f.right)-1))+1,o=e=f.bottom,P=H.Ai.top)),j||(D.top=M.top,D.right+=2,S.j(D,f)&&(j=!0,r=n=f.left-1,o=(e=E.R(Math.max(M.top,f.top),Math.min(M.bottom,f.bottom)-1))+1,P=H.Ai.right)),j||(r=(n=E.R(Math.max(M.left,f.left),Math.min(M.right,f.right)-1))+1,o=e=f.top-1,P=H.Ai.bottom),this.Nh(n,e,H.Rh.jh),this.Nh(r,o,H.Rh.jh),M.mt=!0,this._t.push(M),M.bt||(M.bt=0),f.bt||(f.bt=0),M.bt|=P;var Q=P<<2;8<Q&&(Q>>=4),f.bt|=Q}else M.mt=!1,R.push(M);g+=1}if(1e4<=g)throw new Error("Infinite loop in door placements")},bi:function(){var t,i,h,s=this.Gt;for(h=0;h<this._t.length;h+=1)i=this._t[h],t=new W({x:Math.floor((i.left-.5)*this.Et),y:Math.floor((i.top-.5)*this.Et),m:Math.floor((i.right-i.left+1)*this.Et),rt:Math.floor((i.bottom-i.top+1)*this.Et)}),this.Zt(t),i.xt=t;var n=new a;for(this.Zt(n),h=0;h<s.length;h+=1)i=s[h],t=new W({x:Math.floor((i.left-.5)*this.Et),y:Math.floor((i.top-.5)*this.Et),m:Math.floor((i.right-i.left+1)*this.Et),rt:Math.floor((i.bottom-i.top+1)*this.Et)}),n.Zt(t),i.xt=n},xi:function(){var t,i,h=this._t.slice(),s=E.P(h);for(s.pt=H.zh.Eh,this.Kh(s),this.qt=s;0<h.length;)t=[],200<(i=((s=E.P(h)).right-s.left)*(s.bottom-s.top))&&t.push(H.zh.Wh),100<=i&&t.push(H.zh.Hh),i<100&&t.push(H.zh.Bh),100<=i&&(0===this.Nt.length||Math.random()<.1)&&t.push(H.zh.Sh),s.pt=E.A(t),s.pt===H.zh.Sh&&this.Nt.push(s),this.Kh(s)},Zh:function(i,h,t,s){var n,e,r=s.width/2,o=s.Lh/2,u=s.Th/2,a=[];if(n=[new f(i-o-u/2,h,o+u/2,r)],s.pt===H.Wi.Bi){var c=(s.width-s.Gh)/2;a.push(new p(s.pt,i-o,h-c/2-s.Gh/2,s.Lh,c,s.Th)),a.push(new p(s.pt,i-o,h+c/2+s.Gh/2,s.Lh,c,s.Th))}else a.push(new p(s.pt,i-o,h,s.Lh,s.width,s.Th));return e=t===H.Ai.left?180:t===H.Ai.top?270:t===H.Ai.right?0:90,n.forEach(function(t){t.nh({x:i,y:h},e)}),a.forEach(function(t){t.Ch({x:i,y:h},e)}),[n,a]},Kh:function(i){var t=null,h={left:i.left*this.Et,top:i.top*this.Et,right:i.right*this.Et,bottom:i.bottom*this.Et};i.bt&H.Ai.left&&(h.left+=1.5*this.Et),i.bt&H.Ai.top&&(h.top+=1.5*this.Et),i.bt&H.Ai.right&&(h.right-=1.5*this.Et),i.bt&H.Ai.bottom&&(h.bottom-=1.5*this.Et),i.pt===H.zh.Hh&&(t=this.$h(h)),t&&(i.Mt=t[0],i.yt=t[1]);var s=new W({x:h.left,y:h.top,m:h.right-h.left,rt:h.bottom-h.top,ot:"#007700"});this.Zt(s),i.yt.forEach(function(t){t.It=i,t.Dt.forEach(function(t){this.Zt(t)},this)},this);var n=(i.left+i.right)/2*this.Et,e=(i.top+i.bottom)/2*this.Et,r=new l({at:["Unknown","Mailroom","Lobby","Bullpen","Private","Open"][i.pt],x:n,y:e,ct:"center",ft:"middle",font:"36px Arial"});this.Zt(r)},$h:function(t){var i,h,s,n,e,r,o,u=t.right-t.left,a=t.bottom-t.top,c=[],f=[],l=E.A([H.Yh,H._h]),d=l.Lh+50,v=l.width/2,w=l.Th/2,p=E.R(0,2);if(a<u){for(e=Math.floor(u/d),r=Math.random()*(u-e*d),n=t.top+v;n+v<t.bottom;){for(i=0;i<e;i+=1)s=t.left+i*d+p*(l.Lh+w)+r,h=this.Zh(s,n,p?H.Ai.right:H.Ai.left,l),c=c.concat(h[0]),f=f.concat(h[1]);n+=50+l.width}var y=null,M=null;c.forEach(function(t){(!y||t.y<y.y)&&(y=t),(!M||t.y>M.y)&&(M=t)}),o=Math.random()*(a-(M.y+M.B-(y.y-y.B))),c.forEach(function(t){t.y+=o}),f.forEach(function(t){t.Dt.forEach(function(t){t.y+=o}),t.Ot.y+=o})}else{for(e=Math.floor(a/d),r=Math.random()*(a-e*d),s=t.left+v;s+v<t.right;){for(i=0;i<e;i+=1)n=t.top+i*d+p*(l.Lh+w)+r,h=this.Zh(s,n,p?H.Ai.bottom:H.Ai.top,l),c=c.concat(h[0]),f=f.concat(h[1]);s+=50+l.width}var m=null,x=null;c.forEach(function(t){(!m||t.x<m.x)&&(m=t),(!x||t.x>x.x)&&(x=t)}),o=Math.random()*(u-(x.x+x.W-(m.x-m.W))),c.forEach(function(t){t.x+=o}),f.forEach(function(t){t.Dt.forEach(function(t){t.x+=o}),t.Ot.x+=o})}return[c,f]},ts:function(t,i,h,s){var n=null,e=null,r=this.Et/2,o=null,u=!0;switch(h){case H.Rh.Ph:e=new f(t*this.Et+r,i*this.Et+r,r,r),u=!1;break;case H.Rh.Ah:u=!0;break;case H.Rh.jh:n="#00aa00",u=!0;break;case H.Rh.Qh:u=!0}return n&&(o=new W({x:t*this.Et,y:i*this.Et,m:this.Et,rt:this.Et,ot:n})),{pt:h,hs:o,$t:e,It:s,ss:u}},ns:function(t,i){return this.zt[t]&&this.zt[t][i]?this.zt[t][i]:null},Nh:function(t,i,h,s){this.zt[t]||(this.zt[t]={});var n=this.zt[t][i];n&&n.hs&&this.kh(n.hs),n=this.ts(t,i,h,s),(this.zt[t][i]=n).hs&&this.Zt(n.hs)},es:function(t,i){return this.ns(Math.floor(t/this.Et),Math.floor(i/this.Et))},rs:function(t,i){var h,s,n=[],e=Math.floor(t/this.Et),r=Math.floor(i/this.Et),o=null,u=H.Fh;for(s=0;s<u.length;s+=1)h=u[s],(o=this.ns(e+h.x,r+h.y))&&n.push(o);return n}}),y.prototype=t(a.prototype,{Ri:function(t){this.ri|=t,this.os()},Pi:function(t){this.ri^=t,this.os()},os:function(){this.hi.x=0,this.hi.y=0,this.ri&H.Ai.left&&(this.hi.x-=this.ii),this.ri&H.Ai.right&&(this.hi.x+=this.ii),this.ri&H.Ai.top&&(this.hi.y-=this.ii),this.ri&H.Ai.bottom&&(this.hi.y+=this.ii)},Ci:function(){this.ti.qi(this.$t.x,this.$t.y),this.$t.qi(this.x,this.y)},Ei:function(t){if((this.hi.x||this.hi.y)&&(this.ut.angle=S.Q(this.hi)),this.x+=this.hi.x*t,this.y+=this.hi.y*t,this.Ci(),this.ni){var i,h,s=this.Pt.rs(this.x,this.y);for(i=0;i<s.length;i+=1)!(h=s[i]).ss&&h.$t&&this.us(h.$t)}if(h=this.Pt.es(this.x,this.y),this.ei&&h&&h.It){if(h.It.Mt){var n=h.It.Mt;for(i=0;i<n.length;i+=1)this.us(n[i])}if(h.It.yt){var e=h.It.yt,r=!1;for(i=0;i<e.length;i+=1)if(e[i].pt===H.Wi.Si||e[i].pt===H.Wi.Bi){var o=e[i];o.gt&&o.Ot.th(this.$t)&&o.Dh(this),r=r||o.gt}h.It.gt=r}}if(h&&h.It&&this.si!==h.It){var u=this.si;if(this.si=h.It,u&&(!u.Jh||!this.si.Jh)){u.as&&(u.as.mh(),u.as=null);var a=new c({V:u.xt,X:"alpha",from:0,Y:1,L:.5});u.as=a,this.jt.oi.Yi.xh(a)}this.si.as&&(this.si.as.mh(),this.si.as=null),this.si.xt.alpha=0}},us:function(t){var i,h;t.th(this.$t)&&(i=this.$t.x-t.x,h=this.$t.y-t.y,Math.abs(i)>Math.abs(h)?this.x=0<i?t.Ji()+this.$t.W+1:t.Ni()-this.$t.W-1:this.y=0<h?t.Ki()+this.$t.B+1:t.Ui()-this.$t.B-1,this.Ci())}}),M.prototype=t(a.prototype,{create:function(){},p:function(){},zi:function(t){this.ui.push(t)},Ei:function(t){for(var i=0;i<this.ui.length;i+=1)this.ui[i](t)},bh:function(t){this.gh(t)}}),m.prototype=t(M.prototype,{p:function(){this.keys.forEach(function(t){t.p()})},Ei:function(t){this.Oi.Ei(t),this.Ii||(this.Pt.x=Math.floor(d.width/2-this.Oi.x*this.Pt.$),this.Pt.y=Math.floor(d.height/2-this.Oi.y*this.Pt.tt)),this.cs()},cs:function(){var t,i,h,s,n,e;for(t=0;t<this.ai.length;t+=1)(i=this.ai[t]).gt&&(e=this.di[i.wt],this.Oi.si!==i?(e.it=!0,h=(i.left+i.right)/2*this.Pt.Et,s=(i.top+i.bottom)/2*this.Pt.Et,n=Math.atan2(s-this.Oi.y,h-this.Oi.x),e.angle=n):e.it=!1)},ki:function(){var t,i,h,s=this.Pt._t.filter(function(t){return t.yt&&t.yt.length&&t.yt.some(function(t){return t.pt===H.Wi.Si||t.pt===H.Wi.Bi})}),n=E.R(d.minMailableRooms,Math.max(d.minMailableRooms+1,Math.floor(s.length*d.maxMailableRoomRate))),e=[];for(t=0;t<n;t+=1)i=E.P(s),h=g("white"),this.gi.Zt(h),this.di[i.wt]=h,i.gt=!0,e.push(i);var r=e.reduce(x,[]),o=s.reduce(x,[]),u=E.R(d.minMissingPeople,d.maxMissingPeople+1);u>r.length&&(u=r.length);var a,c,f=[],l=[];for(t=0;t<u;t+=1)a=E.P(r),c=E.P(o),a.Rt=c.wt,c.At=a.wt,f.push(a),l.push(c),a.Qt=this.fs.bind(this),c.Ft=this.ls.bind(this);r.forEach(b),f.forEach(b),l.forEach(b),this.ai=e,this.ci=r,this.fi=f,this.li=l,this.ci.forEach(function(t){t.Dt.forEach(function(t){t.ot="white"})}),this.fi.forEach(function(t){t.Dt.forEach(function(t){t.ot="blue"})}),this.li.forEach(function(t){t.Dt.forEach(function(t){t.ot="gray"})})},fs:function(i){var t=this.li.find(function(t){return t.wt===i.Rt});if(t){if(t.gt&&-1===this.ai.indexOf(t.It)){t.It.gt=!0,this.ai.push(t.It);var h=g("blue");this.di[t.It.wt]=h,this.gi.Zt(h)}}else console.log("desk "+i.Rt+" not found")},ls:function(i){var t=this.fi.find(function(t){return t.wt===i.At});t&&t.gt&&t.Dh(this.Oi)}}),k.prototype=t(M.prototype,{create:function(){Object.entries(F.i).forEach(function(t){var i=new Image;i.onload=this.ds.bind(this),i.src=t[1],this.i.push(i),F.o[t[0]]=i},this)},ds:function(t){if(!this.Hi){var i=this.i.reduce(function(t,i){return(i.complete?1:0)+(t||0)},0);this.Vi.at=Math.floor(i/this.i.length*100)+"%",i>=this.i.length&&this.vs()}},vs:function(){this.Hi||(Object.entries(F.r).forEach(function(t){F.u[t[0]]=this.oi.vt.createPattern(F.o[t[0]],t[1])},this),this.Hi=!0,this.oi.ws(new m(this.oi)))}}),I.prototype={_i:function(){this.Ti(),setTimeout(function(){this.Ti()}.bind(this),100)},Ti:function(){var t,i,h=r.getComputedStyle(o.a("root")),s=parseInt(h.width,10),n=parseInt(h.height,10),e=this.dt.width/this.dt.height;s/n<e?i=(t=s)/e:t=(i=n)*e,this.dt.style.width=Math.floor(t)+"px",this.dt.style.height=Math.floor(i)+"px",this.dt.style.position="absolute",this.dt.style.left="50%",this.dt.style.top="50%",this.dt.style.marginLeft=Math.floor(-t/2)+"px",this.dt.style.marginTop=Math.floor(-i/2)+"px"},ws:function(t){this.jt&&this.jt.p(),(this.jt=t).create()},Ei:function(t){var i=(t-this.K)/1e3;0<i&&(.2<i&&(i=.2),this.jt.Ei(i),this.jt.bh(this.vt),this.Yi.Ei(i),this.K=t),requestAnimationFrame(this.Ei)}},r.game=new I}(window,document);