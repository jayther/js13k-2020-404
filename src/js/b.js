!function(e,i){var r={t:"Lost",width:640,height:360};function E(t,i){"use strict";if(null==t)throw new TypeError("Cannot convert undefined or null to object");for(var h=Object(t),s=1;s<arguments.length;s++){var n=arguments[s];if(null!=n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(h[r]=n[r])}return h}function t(){return E.apply(this,[{}].concat(Array.prototype.slice.call(arguments)))}var h,o=(h={},{i:function(t){return h[t]||(h[t]=i.getElementById(t)),h[t]},create:function(t){return i.createElement(t)}});function u(t,i,h){var s={h:t,s:!1,n:i,r:h,e:function(t){t.keyCode===s.h&&(!s.s&&s.n&&s.n(),s.s=!0),t.preventDefault()},o:function(t){t.keyCode===s.h&&(s.s&&s.r&&s.r(),s.s=!1),t.preventDefault()},u:function(){e.removeEventListener("keydown",s.e,!1),e.removeEventListener("keyup",s.o,!1)}};return e.addEventListener("keydown",s.e,!1),e.addEventListener("keyup",s.o,!1),s}u.keys={a:65,f:87,c:83,l:68,left:37,d:38,right:39,w:40,v:32,p:13};var H=null;H={M:function(t,i){return t+Math.random()*(i-t)},y:function(t,i){return Math.floor(H.M(t,i))},x:function(t){return t[H.y(0,t.length)]}};var W=function(t,i){var h=(t.right+t.left)/2,s=(t.bottom+t.top)/2,n=t.right-t.left,r=t.bottom-t.top,e=(i.right+i.left)/2,o=(i.bottom+i.top)/2,u=i.right-i.left,a=i.bottom-i.top;return 2*Math.abs(h-e)<n+u&&2*Math.abs(s-o)<r+a};function a(t,i,h,s){this.b=t||0,this.m=i||0,this.g=h||0,this.I=s||0}function f(t){this.C=E({O:null,k:null,from:0,Q:1,j:1,A:f.W.H,z:null},t||{}),this.D=-1,this.F=-1,this.P=!1}function s(){this.B=0,this.S=[]}function n(t){var i=E({b:0,m:0,T:1,_:1,q:0,G:!0,alpha:1},t||{});this.b=i.b,this.m=i.m,this.T=i.T,this._=i._,this.q=i.q,this.G=i.G,this.alpha=i.alpha}function z(t){n.apply(this,arguments),this.L=[]}function D(t){n.apply(this,arguments);var i=E({f:0,R:0,X:"black"},t||{});this.f=i.f,this.R=i.R,this.X=i.X}function c(t){z.apply(this,arguments);var i=E({f:100,R:100},t||{});this.Y=o.create("canvas"),this.Y.width=i.f,this.Y.height=i.R,this.J=this.Y.getContext("2d")}function F(){z.apply(this,arguments),this.K={},this.N=20,this.U=1e3,this.V=20,this.Z=20,this.$=100,this.tt=10,this.it=10,this.ht=2,this.st=0,this.nt=0,this.rt=[],this.et=[],this.ot=new c,this.ut(this.ot)}function l(t,i){z.call(this,i),this.at=t;var h=E({ft:null},i||{});this.ct=new a(0,0,5,5),this.lt={b:0,m:0},this.ft=h.ft,this.dt=null;var s=this.rect=new D({b:-5,m:-5,f:10,R:10,X:"blue"});this.ut(s)}function d(t,i){z.call(this),this.wt=t,this.C=i,this.vt=[]}function w(){d.apply(this,arguments),this.pt={Mt:50,yt:60,xt:50,bt:60},this.st=H.y(this.pt.Mt,this.pt.yt),this.nt=H.y(this.pt.xt,this.pt.bt);var t=new D({f:r.width,R:r.height,X:"#333333"});this.ut(t),this.ft=new F,this.ut(this.ft),this.ft.mt(this.st,this.nt);var i=200,h=this.gt=new l(this,{ft:this.ft});this.ft.ut(this.gt);var s=H.x(this.ft.rt);this.gt.b=(s.left+s.right)/2*this.ft.N,this.gt.m=(s.top+s.bottom)/2*this.ft.N,this.gt.It();var n=this.gt.lt;this.keys=[],this.Ct=u(u.keys.a,function(){n.b+=-i},function(){n.b-=-i}),this.keys.push(this.Ct),this.Ot=u(u.keys.c,function(){n.m+=i},function(){n.m-=i}),this.keys.push(this.Ot),this.kt=u(u.keys.l,function(){n.b+=i},function(){n.b-=i}),this.keys.push(this.kt),this.Qt=u(u.keys.f,function(){n.m+=-i},function(){n.m-=-i}),this.keys.push(this.Qt),this.jt(this.gt.At.bind(this.gt)),this.jt(function(t){this.ft.b=Math.floor(r.width/2-h.b),this.ft.m=Math.floor(r.height/2-h.m)}.bind(this))}function v(){this.At=this.At.bind(this),this.Et=o.i("root");var t=o.create("canvas");t.width=r.width,t.height=r.height,this.Et.appendChild(t),this.Y=t,this.J=t.getContext("2d"),this.Ht=new s,this.at=new w(this),this.B=0,this.Wt=this.Wt.bind(this),e.addEventListener("resize",this.zt.bind(this),!1),this.zt(),this.At(0)}a.Dt=function(t){return new a((t.left+t.right)/2,(t.top+t.bottom)/2,(t.right-t.right)/2,(t.bottom-t.top)/2)},(a.prototype={}).Ft=function(t,i){this.b=t||0,this.m=i||0},a.prototype.Pt=function(){return this.b-this.g},a.prototype.Bt=function(){return this.m-this.I},a.prototype.St=function(){return this.b+this.g},a.prototype.Tt=function(){return this.m+this.I},a.prototype._t=function(){return 2*this.g},a.prototype.qt=function(){return 2*this.I},a.prototype.Gt=function(t){return Math.abs(this.b-t.b)<this.g+t.g&&Math.abs(this.m-t.m)<this.I+t.I},a.prototype.Lt=function(t,i){return Math.abs(this.b-t)<this.g&&Math.abs(this.m-i)<this.I},f.W={H:function(t){return t},Rt:function(t){return t*t},Xt:function(t){return t*(2-t)},Yt:function(t){return t<.5?2*t*t:(4-2*t)*t-1},Jt:function(t){return t*t*t},Kt:function(t){return--t*t*t+1},Nt:function(t){return t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1},Ut:function(t){return t*t*t*t},Vt:function(t){return 1- --t*t*t*t},Zt:function(t){return t<.5?8*t*t*t*t:1-8*--t*t*t*t},$t:function(t){return t*t*t*t*t},ti:function(t){return 1+--t*t*t*t*t},ii:function(t){return t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t}},f.prototype={hi:function(t){this.D=t,this.F=t+this.C.j},At:function(t){if(this.C.O&&this.C.k){var i=(t-this.D)/this.C.j;1<i&&(i=1);var h=this.C.A(i),s=this.C.from+(this.C.Q-this.C.from)*h;this.C.O[this.C.k]=s}},si:function(){this.P=!0}},s.prototype={ni:function(t){t.hi(this.B),this.S.push(t)},At:function(t){var i,h,s;for(i=0;i<this.S.length;i+=1)s=!1,(h=this.S[i]).P||h.At(this.B),h.P?s=!0:this.B>=h.F&&(h.C.z&&h.C.z(),s=!0),s&&(this.S.splice(i,1),i-=1);this.B+=t}},z.prototype=t(n.prototype={ri:function(t){this.G&&.01<=this.alpha&&(t.save(),(this.b||this.m)&&t.translate(this.b,this.m),1===this.T&&1===this._||t.scale(this.T,this._),this.q&&t.rotate(this.q),this.alpha<1&&(t.globalAlpha*=this.alpha),this.ei(t),t.restore())},ei:function(t){}},{ut:function(t){return this.L.push(t),this},oi:function(t){var i=this.L.indexOf(t);return 0<=i&&this.L.splice(i,1),this},ei:function(t){for(var i=0;i<this.L.length;i+=1)this.L[i].ri(t)}}),D.prototype=t(n.prototype,{ei:function(t){t.fillStyle=this.X,t.fillRect(0,0,this.f,this.R)}}),c.prototype=t(z.prototype,{ui:function(t,i){this.Y.width=t,this.Y.height=i},ut:function(t){z.prototype.ut.apply(this,arguments),this.ai()},oi:function(t){z.prototype.oi.apply(this,arguments),this.ai()},ai:function(){this.J.clearRect(0,0,this.Y.width,this.Y.height);for(var t=0;t<this.L.length;t+=1)this.L[t].ri(this.J)},ei:function(t){t.drawImage(this.Y,0,0)}}),F.fi={ci:1,li:2,di:3,wi:4},F.vi=[{b:1,m:0},{b:0,m:1},{b:-1,m:0},{b:0,m:-1},{b:0,m:0},{b:1,m:1},{b:-1,m:1},{b:-1,m:-1},{b:1,m:-1}],F.prototype=t(z.prototype,{mt:function(t,i){var h,s,n,r,e=t,o=i;for(this.ot.ui(e*this.N,o*this.N),this.ot.ut(new D({b:0*this.N,m:0*this.N,f:e*this.N,R:o*this.N,X:"#000000"})),this.ot.ut(new D({b:1*this.N,m:1*this.N,f:(e-2)*this.N,R:(o-2)*this.N,X:"#656565"})),this.st=e,this.nt=o,h=0;h<e;h+=1)this.pi(h,0,F.fi.li),this.pi(h,o-1,F.fi.li);for(h=0;h<o;h+=1)this.pi(0,h,F.fi.li),this.pi(e-1,h,F.fi.li);for(var u,a,f,c,l,d,w=H.y(0,2),v={left:1,top:1,right:e-1,bottom:o-1,Mi:w},p=[v],M=[],y=[],x=0,b=0,m=this.V,g=this.Z,I=this.U;0<p.length&&x<1e4;)if(a=E({},v=p.shift()),f=null,d=0===(w=v.Mi)?(l="right","left"):(l="bottom","top"),0===b?(c=E({},v),3,f=E({},v),u=H.y(v[d]+m/2,v[l]-m/2),a[l]=u-this.ht/2-1,f[d]=u+this.ht/2+1,c[l]=u+this.ht/2,c[d]=u-this.ht/2,c.yi=!0,M.push(c)):(f=E({},v),u=H.y(v[d]+m/2,v[l]-m/2),a[l]=u,f[d]=u+1),n=a.right-a.left,r=a.bottom-a.top,m<n&&g<r&&I<n*r?(a.Mi=0===b?w?0:1:r<n?0:1,p.push(a)):y.push(a),f&&(n=f.right-f.left,r=f.bottom-f.top,m<n&&g<r&&g<n*r?(f.Mi=0===b?w?0:1:r<n?0:1,p.push(f)):y.push(f)),x+=1,0===b&&0===p.length)for(b+=1,m=this.tt,g=this.it,I=this.$,h=y.length-1;0<=h;h-=1)n=(a=y[h]).right-a.left,r=a.bottom-a.top,m<n&&g<r&&I<n*r&&(a.Mi=r<n?0:1,p.push(a),y.splice(h,1));if(1e4<=x)throw new Error("Infinite loop in partitioning");for(this.et=M,h=0;h<M.length;h+=1)for(n=(c=M[h]).left;n<c.right;n+=1)for(r=c.top;r<c.bottom;r+=1)this.pi(n,r,F.fi.ci,c);var C,O,k=[];for(h=0;h<y.length;h+=1){for(v=y[h],this.ot.ut(new D({b:(v.left-1)*this.N,m:(v.top-1)*this.N,f:(v.right-v.left+2)*this.N,R:(v.bottom-v.top+2)*this.N,X:"#000000"})),this.ot.ut(new D({b:v.left*this.N,m:v.top*this.N,f:(v.right-v.left)*this.N,R:(v.bottom-v.top)*this.N,X:"#999999"})),n=v.left-1;n<v.right+1;n+=1)this.pi(n,v.top-1,F.fi.li),this.pi(n,v.bottom,F.fi.li);for(r=v.top-1;r<v.bottom+1;r+=1)this.pi(v.left-1,r,F.fi.li),this.pi(v.right,r,F.fi.li);for(n=v.left;n<v.right;n+=1)for(r=v.top;r<v.bottom;r+=1)this.pi(n,r,F.fi.wi,v);v.xi=!1,k.push(v)}for(x=0;0<k.length&&x<1e4;){p=x<y.length?M:this.rt;var Q=[];for((C=E({},v=k.shift())).left-=2,C.right+=2,s=0;s<p.length;s+=1)a=p[s],W(C,a)&&Q.push(a);for(C.left=v.left,C.right=v.right,C.top-=2,C.bottom+=2,s=0;s<p.length;s+=1)a=p[s],Q.indexOf(a)<0&&W(C,a)&&Q.push(a);if(0<Q.length){a=H.x(Q),C.left=v.left,C.top=v.top,C.right=v.right,C.bottom=v.bottom;var j=!1;C.left-=2,W(C,a)&&(j=!0,n=a.right,r=H.y(Math.max(v.top,a.top),Math.min(v.bottom,a.bottom))),j||(C.left=v.left,C.top-=2,W(C,a)&&(j=!0,n=H.y(Math.max(v.left,a.left),Math.min(v.right,a.right)),r=a.bottom)),j||(C.top=v.top,C.right+=2,W(C,a)&&(j=!0,n=a.left-1,r=H.y(Math.max(v.top,a.top),Math.min(v.bottom,a.bottom)))),j||(n=H.y(Math.max(v.left,a.left),Math.min(v.right,a.right)),r=a.top-1),this.pi(n,r,F.fi.di),v.xi=!0,this.rt.push(v)}else v.xi=!1,k.push(v);x+=1}if(1e4<=x)throw new Error("Infinite loop in door placements");for(h=0;h<this.rt.length;h+=1)v=this.rt[h],O=new D({b:Math.floor((v.left-.5)*this.N),m:Math.floor((v.top-.5)*this.N),f:Math.floor((v.right-v.left+1)*this.N),R:Math.floor((v.bottom-v.top+1)*this.N)}),this.ut(O),v.bi=O;var A=new z;for(this.ut(A),h=0;h<M.length;h+=1)v=M[h],O=new D({b:Math.floor((v.left-.5)*this.N),m:Math.floor((v.top-.5)*this.N),f:Math.floor((v.right-v.left+1)*this.N),R:Math.floor((v.bottom-v.top+1)*this.N)}),A.ut(O),v.bi=A},mi:function(t,i,h,s){var n=null,r=null,e=this.N/2,o=null,u=!0;switch(h){case F.fi.li:r=new a(t*this.N+e,i*this.N+e,e,e),u=!1;break;case F.fi.ci:u=!0;break;case F.fi.di:n="#00aa00",u=!0;break;case F.fi.wi:u=!0}return n&&(o=new D({b:t*this.N,m:i*this.N,f:this.N,R:this.N,X:n})),{gi:h,Ii:o,ct:r,Ci:s,Oi:u}},ki:function(t,i){return this.K[t]&&this.K[t][i]?this.K[t][i]:null},pi:function(t,i,h,s){this.K[t]||(this.K[t]={});var n=this.K[t][i];n&&n.Ii&&this.oi(n.Ii),n=this.mi(t,i,h,s),(this.K[t][i]=n).Ii&&this.ut(n.Ii)},Qi:function(t,i){return this.ki(Math.floor(t/this.N),Math.floor(i/this.N))},ji:function(t,i){var h,s,n=[],r=Math.floor(t/this.N),e=Math.floor(i/this.N),o=null,u=F.vi;for(s=0;s<u.length;s+=1)h=u[s],(o=this.ki(r+h.b,e+h.m))&&n.push(o);return n}}),l.prototype=t(z.prototype,{It:function(){this.ct.Ft(this.b,this.m)},At:function(t){this.b+=this.lt.b*t,this.m+=this.lt.m*t,this.It();var i,h,s,n,r=this.ft.ji(this.b,this.m);for(i=0;i<r.length;i+=1)!(h=r[i]).Oi&&h.ct&&h.ct.Gt(this.ct)&&(s=this.ct.b-h.ct.b,n=this.ct.m-h.ct.m,Math.abs(s)>Math.abs(n)?this.b=0<s?h.ct.St()+this.ct.g:h.ct.Pt()-this.ct.g:this.m=0<n?h.ct.Tt()+this.ct.I:h.ct.Bt()-this.ct.I,this.It());if((h=this.ft.Qi(this.b,this.m))&&h.Ci&&this.dt!==h.Ci){var e=this.dt;if(this.dt=h.Ci,e&&(!e.yi||!this.dt.yi)){e.Ai&&(e.Ai.si(),e.Ai=null);var o=new f({O:e.bi,k:"alpha",from:0,Q:1,j:.5});e.Ai=o,this.at.wt.Ht.ni(o)}this.dt.Ai&&(this.dt.Ai.si(),this.dt.Ai=null),this.dt.bi.alpha=0}}}),d.prototype=t(z.prototype,{create:function(){},u:function(){},jt:function(t){this.vt.push(t)},At:function(t){for(var i=0;i<this.vt.length;i+=1)this.vt[i](t)},ri:function(t){this.ei(t)}}),w.prototype=t(d.prototype,{u:function(){this.keys.forEach(function(t){t.u()})}}),v.prototype={zt:function(){this.Wt(),setTimeout(function(){this.Wt()}.bind(this),100)},Wt:function(){var t,i,h=e.getComputedStyle(o.i("root")),s=parseInt(h.width,10),n=parseInt(h.height,10),r=this.Y.width/this.Y.height;s/n<r?i=(t=s)/r:t=(i=n)*r,this.Y.style.width=Math.floor(t)+"px",this.Y.style.height=Math.floor(i)+"px",this.Y.style.position="absolute",this.Y.style.left="50%",this.Y.style.top="50%",this.Y.style.marginLeft=Math.floor(-t/2)+"px",this.Y.style.marginTop=Math.floor(-i/2)+"px"},Ei:function(t){this.at&&this.at.u(),(this.at=t).create()},At:function(t){var i=(t-this.B)/1e3;0<i&&(.2<i&&(i=.2),this.at.At(i),this.at.ri(this.J),this.Ht.At(i),this.B=t),requestAnimationFrame(this.At)}},e.game=new v}(window,document);